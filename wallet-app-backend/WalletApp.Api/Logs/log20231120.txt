2023-11-20 13:57:34.233 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 13:57:34.338 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 13:57:34.341 +01:00 [INF] Quartz Scheduler created
2023-11-20 13:57:34.344 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 13:57:34.345 +01:00 [INF] RAMJobStore initialized.
2023-11-20 13:57:34.346 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 13:57:34.347 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 13:57:34.348 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 13:57:34.357 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 13:57:34.361 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 13:57:34.395 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 13:57:34.398 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 13:57:34.399 +01:00 [INF] Hosting environment: Development
2023-11-20 13:57:34.399 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 13:57:34.400 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 13:57:34.501 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 13:57:34.504 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 13:57:34.584 +01:00 [INF] Received HTTP response headers after 76.8674ms - 200
2023-11-20 13:57:34.590 +01:00 [INF] End processing HTTP request after 91.5215ms - 200
2023-11-20 13:57:35.611 +01:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 13:57:35.779 +01:00 [INF] Executed DbCommand (25ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p10='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p11='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = DateTime2), @p19='?' (DbType = Guid), @p15='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p16='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p17='?' (DbType = DateTime2), @p18='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2, [TradingDate] = @p3
OUTPUT 1
WHERE [Id] = @p4;
UPDATE [Currencies] SET [Ask] = @p5, [Bid] = @p6, [ModifiedTime] = @p7, [TradingDate] = @p8
OUTPUT 1
WHERE [Id] = @p9;
UPDATE [Currencies] SET [Ask] = @p10, [Bid] = @p11, [ModifiedTime] = @p12, [TradingDate] = @p13
OUTPUT 1
WHERE [Id] = @p14;
UPDATE [Currencies] SET [Ask] = @p15, [Bid] = @p16, [ModifiedTime] = @p17, [TradingDate] = @p18
OUTPUT 1
WHERE [Id] = @p19;
2023-11-20 13:58:40.581 +01:00 [INF] Application is shutting down...
2023-11-20 13:58:40.592 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED shutting down.
2023-11-20 13:58:40.596 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED paused.
2023-11-20 13:58:40.600 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED Shutdown complete.
2023-11-20 15:14:34.924 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:14:35.019 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:14:35.022 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:14:35.022 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:14:35.024 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:14:35.026 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:14:35.027 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:14:35.027 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:14:35.035 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:14:35.038 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:14:35.070 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:14:35.072 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:14:35.073 +01:00 [INF] Hosting environment: Development
2023-11-20 15:14:35.075 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:14:35.076 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:14:35.174 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:14:35.176 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:14:35.248 +01:00 [INF] Received HTTP response headers after 69.7185ms - 200
2023-11-20 15:14:35.252 +01:00 [INF] End processing HTTP request after 81.5592ms - 200
2023-11-20 15:14:52.522 +01:00 [ERR] An error occurred using the connection to database 'WalletApp' on server 'localhost,1433'.
2023-11-20 15:14:52.534 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.)
 ---> System.ComponentModel.Win32Exception (10061): Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:10061,State:0,Class:20
Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.)
 ---> System.ComponentModel.Win32Exception (10061): Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:10061,State:0,Class:20
2023-11-20 15:14:52.545 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.)
 ---> System.ComponentModel.Win32Exception (10061): Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.CurrencyRepository.GetCurrencies(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 39
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 23
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:10061,State:0,Class:20
2023-11-20 15:14:52.573 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.)
 ---> System.ComponentModel.Win32Exception (10061): Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.CurrencyRepository.GetCurrencies(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 39
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 23
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:10061,State:0,Class:20
   --- End of inner exception stack trace --- [See nested exception: Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.)
 ---> System.ComponentModel.Win32Exception (10061): Nie można nawiązać połączenia, ponieważ komputer docelowy aktywnie go odmawia.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.CurrencyRepository.GetCurrencies(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 39
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 23
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:10061,State:0,Class:20]
2023-11-20 15:22:23.185 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/category/userCategories - -
2023-11-20 15:22:23.221 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:22:23.315 +01:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '19.11.2023 16:25:50', Current time: '20.11.2023 14:22:23'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateJWS(String token, TokenValidationParameters validationParameters, BaseConfiguration currentConfiguration, SecurityToken& signatureValidatedToken, ExceptionDispatchInfo& exceptionThrown)
--- End of stack trace from previous location ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, JwtSecurityToken outerToken, TokenValidationParameters validationParameters, SecurityToken& signatureValidatedToken)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2023-11-20 15:22:23.318 +01:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '19.11.2023 16:25:50', Current time: '20.11.2023 14:22:23'.
2023-11-20 15:22:23.329 +01:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2023-11-20 15:22:23.350 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/category/userCategories - - - 401 - application/json 166.7336ms
2023-11-20 15:22:44.403 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67
2023-11-20 15:22:44.409 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-20 15:22:44.428 +01:00 [INF] Route matched with {action = "Authentication", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto]]] Authentication(WalletApp.Application.Account.Authenticate.AuthenticateDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-20 15:22:44.626 +01:00 [INF] Executed DbCommand (35ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-20 15:22:44.852 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__user_Id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2023-11-20 15:22:44.879 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2023-11-20 15:22:44.894 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2023-11-20 15:22:44.900 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-20 15:22:44.906 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2023-11-20 15:22:44.937 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Guid), @__ipAddress_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [t].[Id], [t].[IpAddress], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[UserIdentityId]
FROM [Tokens] AS [t]
WHERE [t].[UserIdentityId] = @__userId_0 AND [t].[IpAddress] = @__ipAddress_1
2023-11-20 15:22:44.970 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-20 15:22:45.069 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p15='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p16='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Int32), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 256), @p8='?' (Size = 256), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 256), @p19='?' (DbType = Guid), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [IconType] = @p4, [LockoutEnabled] = @p5, [LockoutEnd] = @p6, [NormalizedEmail] = @p7, [NormalizedUserName] = @p8, [PasswordHash] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [SecurityStamp] = @p12, [TwoFactorEnabled] = @p13, [UserName] = @p14
OUTPUT 1
WHERE [Id] = @p15 AND [ConcurrencyStamp] = @p16;
UPDATE [Tokens] SET [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18
OUTPUT 1
WHERE [Id] = @p19;
2023-11-20 15:22:45.104 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-20 15:22:45.122 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Authentication (WalletApp.Api) in 688.5606ms
2023-11-20 15:22:45.125 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-20 15:22:45.130 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67 - 200 - application/json;+charset=utf-8 726.6622ms
2023-11-20 15:22:56.507 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/category/userCategories - -
2023-11-20 15:22:56.533 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.CategoryController.GetUserCategories (WalletApp.Api)'
2023-11-20 15:22:56.563 +01:00 [INF] Route matched with {action = "GetUserCategories", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[System.Collections.Generic.List`1[WalletApp.Application.Common.Category.GetUserCategories.GetUserCategoriesResponseDto]]]] GetUserCategories(System.Threading.CancellationToken) on controller WalletApp.Controllers.CategoryController (WalletApp.Api).
2023-11-20 15:22:56.660 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CratedBy], [c].[CreatedTime], [c].[DeletedBy], [c].[DeletedTime], [c].[GroupId], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[Name], [c].[UserIdentityId]
FROM [Categories] AS [c]
WHERE [c].[UserIdentityId] = @__id_0 AND [c].[IsDeleted] = CAST(0 AS bit)
2023-11-20 15:22:56.696 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[System.Collections.Generic.List`1[[WalletApp.Application.Common.Category.GetUserCategories.GetUserCategoriesResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-20 15:22:56.706 +01:00 [INF] Executed action WalletApp.Controllers.CategoryController.GetUserCategories (WalletApp.Api) in 115.6957ms
2023-11-20 15:22:56.706 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.CategoryController.GetUserCategories (WalletApp.Api)'
2023-11-20 15:22:56.708 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/category/userCategories - - - 200 - application/json;+charset=utf-8 200.1157ms
2023-11-20 15:23:27.991 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/currency - -
2023-11-20 15:23:27.993 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.CurrencyController.GetCurrencies (WalletApp.Api)'
2023-11-20 15:23:27.996 +01:00 [INF] Route matched with {action = "GetCurrencies", controller = "Currency"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[System.Collections.Generic.List`1[WalletApp.Application.Common.Currency.GetCurrency.GetCurrenciesQueryResponseDto]]]] GetCurrencies(System.Threading.CancellationToken) on controller WalletApp.Controllers.CurrencyController (WalletApp.Api).
2023-11-20 15:23:28.004 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:23:28.031 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[System.Collections.Generic.List`1[[WalletApp.Application.Common.Currency.GetCurrency.GetCurrenciesQueryResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-20 15:23:28.036 +01:00 [INF] Executed action WalletApp.Controllers.CurrencyController.GetCurrencies (WalletApp.Api) in 38.7538ms
2023-11-20 15:23:28.037 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.CurrencyController.GetCurrencies (WalletApp.Api)'
2023-11-20 15:23:28.038 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/currency - - - 200 - application/json;+charset=utf-8 46.5005ms
2023-11-20 15:23:39.311 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 231
2023-11-20 15:23:39.312 +01:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2023-11-20 15:23:39.313 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 231 - 401 - application/json 2.1551ms
2023-11-20 15:23:55.241 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 231
2023-11-20 15:23:55.243 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:23:55.247 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:23:55.269 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2023-11-20 15:23:55.272 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 23.2318ms
2023-11-20 15:23:55.273 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:23:55.274 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 231 - 400 - application/problem+json;+charset=utf-8 32.5878ms
2023-11-20 15:24:43.651 +01:00 [INF] Application is shutting down...
2023-11-20 15:24:43.660 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED shutting down.
2023-11-20 15:24:43.663 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED paused.
2023-11-20 15:24:43.667 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED Shutdown complete.
2023-11-20 15:24:53.263 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:24:53.411 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:24:53.413 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:24:53.414 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:24:53.415 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:24:53.416 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:24:53.417 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:24:53.418 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:24:53.427 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:24:53.431 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:24:53.512 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:24:53.514 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:24:53.519 +01:00 [INF] Hosting environment: Development
2023-11-20 15:24:53.520 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:24:53.522 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:24:53.686 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:24:53.690 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:24:53.777 +01:00 [INF] Received HTTP response headers after 83.5905ms - 200
2023-11-20 15:24:53.781 +01:00 [INF] End processing HTTP request after 98.7957ms - 200
2023-11-20 15:24:55.170 +01:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:24:55.396 +01:00 [INF] Executed DbCommand (32ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p6='?' (DbType = Guid), @p3='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (DbType = DateTime2), @p10='?' (DbType = Guid), @p7='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p11='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Bid] = @p0, [ModifiedTime] = @p1
OUTPUT 1
WHERE [Id] = @p2;
UPDATE [Currencies] SET [Ask] = @p3, [Bid] = @p4, [ModifiedTime] = @p5
OUTPUT 1
WHERE [Id] = @p6;
UPDATE [Currencies] SET [Ask] = @p7, [Bid] = @p8, [ModifiedTime] = @p9
OUTPUT 1
WHERE [Id] = @p10;
UPDATE [Currencies] SET [Ask] = @p11, [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 15:25:08.536 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 231
2023-11-20 15:25:08.576 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:25:08.756 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:25:08.772 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:25:08.849 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2023-11-20 15:25:08.867 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 88.1037ms
2023-11-20 15:25:08.869 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:25:08.874 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 231 - 400 - application/problem+json;+charset=utf-8 339.0006ms
2023-11-20 15:25:47.265 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 285
2023-11-20 15:25:47.273 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:25:47.279 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:25:47.284 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2023-11-20 15:25:47.285 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 4.6012ms
2023-11-20 15:25:47.287 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:25:47.288 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 285 - 400 - application/problem+json;+charset=utf-8 22.9344ms
2023-11-20 15:28:46.969 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 272
2023-11-20 15:28:46.976 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:28:46.978 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:28:47.110 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:28:47.131 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:01c1141a-5587-45d5-98e2-04a9238afcdd
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:01c1141a-5587-45d5-98e2-04a9238afcdd
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-20 15:28:47.323 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 343.2039ms
2023-11-20 15:28:47.326 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:28:47.397 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:01c1141a-5587-45d5-98e2-04a9238afcdd
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.TransactionRepository.SaveAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\TransactionRepository.cs:line 22
   at WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandHandler.Handle(AddUserTransactionCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Transaction\AddUserTransaction\AddUserTransactionCommandHandler.cs:line 33
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Controllers.TransactionController.AddUserTransaction(AddUserTransactionCommandDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\TransactionController.cs:line 38
   at lambda_method180(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at WalletApp.Middleware.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Middleware\AuthorizationMiddlewareResultHandler.cs:line 39
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-20 15:28:47.424 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 272 - 500 - text/plain;+charset=utf-8 456.9921ms
2023-11-20 15:33:06.158 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-20 15:33:06.196 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-20 15:33:06.199 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-20 15:33:06.201 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-20 15:33:06.214 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2023-11-20 15:33:06.228 +01:00 [INF] Applying migration '20231120143240_guid_null'.
2023-11-20 15:33:06.314 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Categories]
WHERE [Id] = 'b30c5ec9-2a7c-4fdb-bb95-f8b8a3ad56de';
SELECT @@ROWCOUNT;
2023-11-20 15:33:06.318 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '04d23244-906e-46bb-8f49-b41f9c91843e';
SELECT @@ROWCOUNT;
2023-11-20 15:33:06.322 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '0c0fb5a4-6e0c-4c31-a599-fb7dd41ae0a6';
SELECT @@ROWCOUNT;
2023-11-20 15:33:06.325 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '12d7f549-f196-41d8-bfc0-dc5de47a810c';
SELECT @@ROWCOUNT;
2023-11-20 15:33:06.329 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = 'b127be30-2713-4bad-a2a4-8d257ceeed62';
SELECT @@ROWCOUNT;
2023-11-20 15:33:06.350 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Currencies]') AND [c].[name] = N'TradingDate');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Currencies] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Currencies] ALTER COLUMN [TradingDate] datetime2 NOT NULL;
2023-11-20 15:33:06.362 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'GroupId', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name', N'UserIdentityId') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] ON;
INSERT INTO [Categories] ([Id], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Name], [UserIdentityId])
VALUES ('e13b1786-d044-4c0e-bd75-cdcced505e6a', NULL, NULL, NULL, NULL, NULL, CAST(0 AS bit), NULL, NULL, N'Rachunki', NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'GroupId', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name', N'UserIdentityId') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] OFF;
2023-11-20 15:33:06.376 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Ask', N'Bid', N'Code', N'CratedBy', N'CreatedTime', N'CurrencyName', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'TradingDate') AND [object_id] = OBJECT_ID(N'[Currencies]'))
    SET IDENTITY_INSERT [Currencies] ON;
INSERT INTO [Currencies] ([Id], [Ask], [Bid], [Code], [CratedBy], [CreatedTime], [CurrencyName], [DeletedBy], [DeletedTime], [IsDeleted], [ModifiedBy], [ModifiedTime], [TradingDate])
VALUES ('4579fb52-c163-4b02-88d3-25b32be66c79', 4.055, 3.972, N'GBP', NULL, NULL, N'funt szterling', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-20T15:32:40.3711720+01:00'),
('52c656f3-448f-4659-90d5-662f2e47f386', 4.055, 3.972, N'EUR', NULL, NULL, N'euro', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-20T15:32:40.3711711+01:00'),
('7ce84db1-04e7-4517-8b5c-0ff3222931d3', 4.055, 3.972, N'USD', NULL, NULL, N'dolar amerykanski', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-20T15:32:40.3711652+01:00'),
('925d293d-59eb-462b-973d-9f3ea8023b11', 4.055, 3.972, N'CHF', NULL, NULL, N'frank szwajcarski', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-20T15:32:40.3711716+01:00');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Ask', N'Bid', N'Code', N'CratedBy', N'CreatedTime', N'CurrencyName', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'TradingDate') AND [object_id] = OBJECT_ID(N'[Currencies]'))
    SET IDENTITY_INSERT [Currencies] OFF;
2023-11-20 15:33:06.379 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20231120143240_guid_null', N'7.0.12');
2023-11-20 15:35:15.797 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:35:15.889 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:35:15.891 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:35:15.891 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:35:15.892 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:35:15.893 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:35:15.894 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:35:15.894 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:35:15.901 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:35:15.904 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:35:15.933 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:35:15.934 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:35:15.935 +01:00 [INF] Hosting environment: Development
2023-11-20 15:35:15.936 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:35:15.937 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:35:16.029 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:35:16.032 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:35:16.117 +01:00 [INF] Received HTTP response headers after 81.5101ms - 200
2023-11-20 15:35:16.121 +01:00 [INF] End processing HTTP request after 94.2448ms - 200
2023-11-20 15:35:17.093 +01:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:35:17.245 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p10='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p11='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = DateTime2), @p19='?' (DbType = Guid), @p15='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p16='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p17='?' (DbType = DateTime2), @p18='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2, [TradingDate] = @p3
OUTPUT 1
WHERE [Id] = @p4;
UPDATE [Currencies] SET [Ask] = @p5, [Bid] = @p6, [ModifiedTime] = @p7, [TradingDate] = @p8
OUTPUT 1
WHERE [Id] = @p9;
UPDATE [Currencies] SET [Ask] = @p10, [Bid] = @p11, [ModifiedTime] = @p12, [TradingDate] = @p13
OUTPUT 1
WHERE [Id] = @p14;
UPDATE [Currencies] SET [Ask] = @p15, [Bid] = @p16, [ModifiedTime] = @p17, [TradingDate] = @p18
OUTPUT 1
WHERE [Id] = @p19;
2023-11-20 15:35:20.643 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 272
2023-11-20 15:35:20.673 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:35:20.768 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:35:20.780 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:35:20.923 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:35:20.937 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:63cf1902-21ee-482f-9adf-1c3f95582e63
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:63cf1902-21ee-482f-9adf-1c3f95582e63
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-20 15:35:20.950 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 165.7239ms
2023-11-20 15:35:20.951 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:35:20.955 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:63cf1902-21ee-482f-9adf-1c3f95582e63
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.TransactionRepository.SaveAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\TransactionRepository.cs:line 22
   at WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandHandler.Handle(AddUserTransactionCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Transaction\AddUserTransaction\AddUserTransactionCommandHandler.cs:line 33
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Controllers.TransactionController.AddUserTransaction(AddUserTransactionCommandDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\TransactionController.cs:line 38
   at lambda_method179(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at WalletApp.Middleware.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Middleware\AuthorizationMiddlewareResultHandler.cs:line 39
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-20 15:35:20.976 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 272 - 500 - text/plain;+charset=utf-8 333.9561ms
2023-11-20 15:35:43.578 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 219
2023-11-20 15:35:43.592 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:35:43.594 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:35:43.604 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2023-11-20 15:35:43.611 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 14.2547ms
2023-11-20 15:35:43.612 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:35:43.613 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 219 - 400 - application/problem+json;+charset=utf-8 34.9362ms
2023-11-20 15:36:28.423 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218
2023-11-20 15:36:28.429 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:36:28.431 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:36:28.490 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:36:28.493 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:63cf1902-21ee-482f-9adf-1c3f95582e63
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:63cf1902-21ee-482f-9adf-1c3f95582e63
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-20 15:36:28.500 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 68.1847ms
2023-11-20 15:36:28.502 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:36:28.503 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'GroupId', table 'WalletApp.dbo.Transactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:63cf1902-21ee-482f-9adf-1c3f95582e63
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.TransactionRepository.SaveAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\TransactionRepository.cs:line 22
   at WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandHandler.Handle(AddUserTransactionCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Transaction\AddUserTransaction\AddUserTransactionCommandHandler.cs:line 33
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Controllers.TransactionController.AddUserTransaction(AddUserTransactionCommandDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\TransactionController.cs:line 38
   at lambda_method179(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at WalletApp.Middleware.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Middleware\AuthorizationMiddlewareResultHandler.cs:line 39
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-20 15:36:28.514 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218 - 500 - text/plain;+charset=utf-8 90.6657ms
2023-11-20 15:39:11.328 +01:00 [INF] Application is shutting down...
2023-11-20 15:39:11.334 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED shutting down.
2023-11-20 15:39:11.336 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED paused.
2023-11-20 15:39:11.339 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED Shutdown complete.
2023-11-20 15:39:54.317 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-20 15:39:54.356 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-20 15:39:54.365 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2023-11-20 15:39:54.370 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-20 15:39:54.372 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-20 15:39:54.373 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-20 15:39:54.374 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-20 15:39:54.375 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2023-11-20 15:39:54.384 +01:00 [INF] Reverting migration '20231120143240_guid_null'.
2023-11-20 15:39:54.444 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Categories]
WHERE [Id] = 'e13b1786-d044-4c0e-bd75-cdcced505e6a';
SELECT @@ROWCOUNT;
2023-11-20 15:39:54.448 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '4579fb52-c163-4b02-88d3-25b32be66c79';
SELECT @@ROWCOUNT;
2023-11-20 15:39:54.452 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '52c656f3-448f-4659-90d5-662f2e47f386';
SELECT @@ROWCOUNT;
2023-11-20 15:39:54.456 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '7ce84db1-04e7-4517-8b5c-0ff3222931d3';
SELECT @@ROWCOUNT;
2023-11-20 15:39:54.460 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '925d293d-59eb-462b-973d-9f3ea8023b11';
SELECT @@ROWCOUNT;
2023-11-20 15:39:54.478 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Currencies]') AND [c].[name] = N'TradingDate');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Currencies] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Currencies] ALTER COLUMN [TradingDate] datetime NOT NULL;
2023-11-20 15:39:54.489 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'GroupId', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name', N'UserIdentityId') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] ON;
INSERT INTO [Categories] ([Id], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Name], [UserIdentityId])
VALUES ('b30c5ec9-2a7c-4fdb-bb95-f8b8a3ad56de', NULL, NULL, NULL, NULL, NULL, CAST(0 AS bit), NULL, NULL, N'Rachunki', NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'GroupId', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name', N'UserIdentityId') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] OFF;
2023-11-20 15:39:54.503 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Ask', N'Bid', N'Code', N'CratedBy', N'CreatedTime', N'CurrencyName', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'TradingDate') AND [object_id] = OBJECT_ID(N'[Currencies]'))
    SET IDENTITY_INSERT [Currencies] ON;
INSERT INTO [Currencies] ([Id], [Ask], [Bid], [Code], [CratedBy], [CreatedTime], [CurrencyName], [DeletedBy], [DeletedTime], [IsDeleted], [ModifiedBy], [ModifiedTime], [TradingDate])
VALUES ('04d23244-906e-46bb-8f49-b41f9c91843e', 4.055, 3.972, N'USD', NULL, NULL, N'dolar amerykanski', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-19T17:28:38.654'),
('0c0fb5a4-6e0c-4c31-a599-fb7dd41ae0a6', 4.055, 3.972, N'GBP', NULL, NULL, N'funt szterling', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-19T17:28:38.654'),
('12d7f549-f196-41d8-bfc0-dc5de47a810c', 4.055, 3.972, N'EUR', NULL, NULL, N'euro', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-19T17:28:38.654'),
('b127be30-2713-4bad-a2a4-8d257ceeed62', 4.055, 3.972, N'CHF', NULL, NULL, N'frank szwajcarski', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-19T17:28:38.654');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Ask', N'Bid', N'Code', N'CratedBy', N'CreatedTime', N'CurrencyName', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'TradingDate') AND [object_id] = OBJECT_ID(N'[Currencies]'))
    SET IDENTITY_INSERT [Currencies] OFF;
2023-11-20 15:39:54.511 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [__EFMigrationsHistory]
WHERE [MigrationId] = N'20231120143240_guid_null';
2023-11-20 15:40:35.943 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-20 15:40:35.983 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-20 15:40:35.985 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-20 15:40:35.987 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-20 15:40:35.999 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2023-11-20 15:40:36.013 +01:00 [INF] Applying migration '20231120144019_guid_null'.
2023-11-20 15:40:36.096 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Transactions] DROP CONSTRAINT [FK_Transactions_Groups_GroupId];
2023-11-20 15:40:36.097 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Categories]
WHERE [Id] = 'b30c5ec9-2a7c-4fdb-bb95-f8b8a3ad56de';
SELECT @@ROWCOUNT;
2023-11-20 15:40:36.101 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '04d23244-906e-46bb-8f49-b41f9c91843e';
SELECT @@ROWCOUNT;
2023-11-20 15:40:36.104 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '0c0fb5a4-6e0c-4c31-a599-fb7dd41ae0a6';
SELECT @@ROWCOUNT;
2023-11-20 15:40:36.107 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '12d7f549-f196-41d8-bfc0-dc5de47a810c';
SELECT @@ROWCOUNT;
2023-11-20 15:40:36.110 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = 'b127be30-2713-4bad-a2a4-8d257ceeed62';
SELECT @@ROWCOUNT;
2023-11-20 15:40:36.125 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Transactions]') AND [c].[name] = N'GroupId');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Transactions] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Transactions] ALTER COLUMN [GroupId] uniqueidentifier NULL;
2023-11-20 15:40:36.141 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Currencies]') AND [c].[name] = N'TradingDate');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [Currencies] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [Currencies] ALTER COLUMN [TradingDate] datetime2 NOT NULL;
2023-11-20 15:40:36.153 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'GroupId', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name', N'UserIdentityId') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] ON;
INSERT INTO [Categories] ([Id], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Name], [UserIdentityId])
VALUES ('78adf0ca-9d91-4f95-8ebe-803133056425', NULL, NULL, NULL, NULL, NULL, CAST(0 AS bit), NULL, NULL, N'Rachunki', NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'GroupId', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name', N'UserIdentityId') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] OFF;
2023-11-20 15:40:36.167 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Ask', N'Bid', N'Code', N'CratedBy', N'CreatedTime', N'CurrencyName', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'TradingDate') AND [object_id] = OBJECT_ID(N'[Currencies]'))
    SET IDENTITY_INSERT [Currencies] ON;
INSERT INTO [Currencies] ([Id], [Ask], [Bid], [Code], [CratedBy], [CreatedTime], [CurrencyName], [DeletedBy], [DeletedTime], [IsDeleted], [ModifiedBy], [ModifiedTime], [TradingDate])
VALUES ('5abc9602-4079-480b-89b9-49a1aca75cd8', 4.055, 3.972, N'GBP', NULL, NULL, N'funt szterling', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-20T15:40:19.2412449+01:00'),
('636a6aa2-04c7-4729-9b3b-acc26748c576', 4.055, 3.972, N'EUR', NULL, NULL, N'euro', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-20T15:40:19.2412429+01:00'),
('d477eede-7883-466e-9100-2548f1f6afc7', 4.055, 3.972, N'CHF', NULL, NULL, N'frank szwajcarski', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-20T15:40:19.2412432+01:00'),
('f608d049-bc63-4018-9f73-2f63ed709bac', 4.055, 3.972, N'USD', NULL, NULL, N'dolar amerykanski', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-20T15:40:19.2412384+01:00');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Ask', N'Bid', N'Code', N'CratedBy', N'CreatedTime', N'CurrencyName', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'TradingDate') AND [object_id] = OBJECT_ID(N'[Currencies]'))
    SET IDENTITY_INSERT [Currencies] OFF;
2023-11-20 15:40:36.170 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Transactions] ADD CONSTRAINT [FK_Transactions_Groups_GroupId] FOREIGN KEY ([GroupId]) REFERENCES [Groups] ([Id]);
2023-11-20 15:40:36.171 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20231120144019_guid_null', N'7.0.12');
2023-11-20 15:40:57.027 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:40:57.173 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:40:57.175 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:40:57.176 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:40:57.177 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:40:57.178 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:40:57.179 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:40:57.180 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:40:57.190 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:40:57.193 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:40:57.268 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:40:57.269 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:40:57.274 +01:00 [INF] Hosting environment: Development
2023-11-20 15:40:57.275 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:40:57.278 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:40:57.451 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:40:57.454 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:40:57.557 +01:00 [INF] Received HTTP response headers after 99.7645ms - 200
2023-11-20 15:40:57.561 +01:00 [INF] End processing HTTP request after 114.8851ms - 200
2023-11-20 15:40:58.860 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:40:59.041 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[@p4='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p7='?' (DbType = DateTime2), @p8='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p10='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p11='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p12='?' (DbType = DateTime2), @p13='?' (DbType = DateTime2), @p19='?' (DbType = Guid), @p15='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p16='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p17='?' (DbType = DateTime2), @p18='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2, [TradingDate] = @p3
OUTPUT 1
WHERE [Id] = @p4;
UPDATE [Currencies] SET [Ask] = @p5, [Bid] = @p6, [ModifiedTime] = @p7, [TradingDate] = @p8
OUTPUT 1
WHERE [Id] = @p9;
UPDATE [Currencies] SET [Ask] = @p10, [Bid] = @p11, [ModifiedTime] = @p12, [TradingDate] = @p13
OUTPUT 1
WHERE [Id] = @p14;
UPDATE [Currencies] SET [Ask] = @p15, [Bid] = @p16, [ModifiedTime] = @p17, [TradingDate] = @p18
OUTPUT 1
WHERE [Id] = @p19;
2023-11-20 15:41:05.534 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218
2023-11-20 15:41:05.577 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:41:05.754 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:41:05.769 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:41:05.939 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:41:05.961 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_AspNetUsers_UserIdentityId". The conflict occurred in database "WalletApp", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4cafa15a-aa10-492c-a1ad-a5f676faa7e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_AspNetUsers_UserIdentityId". The conflict occurred in database "WalletApp", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4cafa15a-aa10-492c-a1ad-a5f676faa7e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-20 15:41:06.156 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 382.3545ms
2023-11-20 15:41:06.159 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:41:06.228 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_AspNetUsers_UserIdentityId". The conflict occurred in database "WalletApp", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4cafa15a-aa10-492c-a1ad-a5f676faa7e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.TransactionRepository.SaveAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\TransactionRepository.cs:line 22
   at WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandHandler.Handle(AddUserTransactionCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Transaction\AddUserTransaction\AddUserTransactionCommandHandler.cs:line 33
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Controllers.TransactionController.AddUserTransaction(AddUserTransactionCommandDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\TransactionController.cs:line 38
   at lambda_method179(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at WalletApp.Middleware.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Middleware\AuthorizationMiddlewareResultHandler.cs:line 39
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-20 15:41:06.257 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218 - 500 - text/plain;+charset=utf-8 725.2476ms
2023-11-20 15:42:02.497 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:42:02.635 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:42:02.636 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:42:02.637 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:42:02.638 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:42:02.640 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:42:02.641 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:42:02.642 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:42:02.650 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:42:02.653 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:42:02.735 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:42:02.736 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:42:02.740 +01:00 [INF] Hosting environment: Development
2023-11-20 15:42:02.741 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:42:02.744 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:42:02.897 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:42:02.901 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:42:02.985 +01:00 [INF] Received HTTP response headers after 81.4457ms - 200
2023-11-20 15:42:02.990 +01:00 [INF] End processing HTTP request after 96.8428ms - 200
2023-11-20 15:42:04.192 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:42:04.370 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 15:42:37.624 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218
2023-11-20 15:42:37.680 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:42:37.866 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:42:37.881 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:42:38.048 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:42:38.071 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_AspNetUsers_UserIdentityId". The conflict occurred in database "WalletApp", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d2b7c247-e2d6-4687-9dc4-787caaceba7d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_AspNetUsers_UserIdentityId". The conflict occurred in database "WalletApp", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d2b7c247-e2d6-4687-9dc4-787caaceba7d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-20 15:42:38.256 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 368.858ms
2023-11-20 15:42:38.259 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:42:38.323 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_AspNetUsers_UserIdentityId". The conflict occurred in database "WalletApp", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d2b7c247-e2d6-4687-9dc4-787caaceba7d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.TransactionRepository.SaveAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\TransactionRepository.cs:line 22
   at WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandHandler.Handle(AddUserTransactionCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Transaction\AddUserTransaction\AddUserTransactionCommandHandler.cs:line 33
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Controllers.TransactionController.AddUserTransaction(AddUserTransactionCommandDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\TransactionController.cs:line 38
   at lambda_method180(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at WalletApp.Middleware.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Middleware\AuthorizationMiddlewareResultHandler.cs:line 39
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-20 15:42:38.353 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218 - 500 - text/plain;+charset=utf-8 731.1258ms
2023-11-20 15:44:17.828 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218
2023-11-20 15:44:17.839 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:44:17.841 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:49:30.584 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:49:30.719 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:49:30.720 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:49:30.721 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:49:30.722 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:49:30.723 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:49:30.724 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:49:30.725 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:49:30.734 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:49:30.737 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:49:30.820 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:49:30.822 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:49:30.827 +01:00 [INF] Hosting environment: Development
2023-11-20 15:49:30.827 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:49:30.830 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:49:30.986 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:49:30.988 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:49:31.078 +01:00 [INF] Received HTTP response headers after 87.1451ms - 200
2023-11-20 15:49:31.084 +01:00 [INF] End processing HTTP request after 101.7479ms - 200
2023-11-20 15:49:32.277 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:49:32.449 +01:00 [INF] Executed DbCommand (23ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 15:50:17.035 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218
2023-11-20 15:50:17.080 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:50:17.263 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:50:17.280 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:50:17.473 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__get_Item_0
2023-11-20 15:50:17.616 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:50:17.635 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_Currencies_CurrencyId". The conflict occurred in database "WalletApp", table "dbo.Currencies", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:41478a17-edc4-4900-8755-20baa111bc3e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_Currencies_CurrencyId". The conflict occurred in database "WalletApp", table "dbo.Currencies", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:41478a17-edc4-4900-8755-20baa111bc3e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-20 15:50:17.835 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 548.7569ms
2023-11-20 15:50:17.837 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:50:17.915 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_Currencies_CurrencyId". The conflict occurred in database "WalletApp", table "dbo.Currencies", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:41478a17-edc4-4900-8755-20baa111bc3e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.TransactionRepository.SaveAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\TransactionRepository.cs:line 22
   at WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandHandler.Handle(AddUserTransactionCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Transaction\AddUserTransaction\AddUserTransactionCommandHandler.cs:line 41
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Controllers.TransactionController.AddUserTransaction(AddUserTransactionCommandDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\TransactionController.cs:line 38
   at lambda_method180(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at WalletApp.Middleware.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Middleware\AuthorizationMiddlewareResultHandler.cs:line 39
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-20 15:50:18.014 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218 - 500 - text/plain;+charset=utf-8 981.7609ms
2023-11-20 15:52:46.622 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:52:46.764 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:52:46.765 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:52:46.766 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:52:46.768 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:52:46.769 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:52:46.769 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:52:46.770 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:52:46.780 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:52:46.783 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:52:46.858 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:52:46.860 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:52:46.865 +01:00 [INF] Hosting environment: Development
2023-11-20 15:52:46.866 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:52:46.868 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:52:47.026 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:52:47.029 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:52:47.116 +01:00 [INF] Received HTTP response headers after 84.3746ms - 200
2023-11-20 15:52:47.122 +01:00 [INF] End processing HTTP request after 100.406ms - 200
2023-11-20 15:52:48.401 +01:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:52:48.579 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 15:52:50.487 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218
2023-11-20 15:52:50.533 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:52:50.717 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:52:50.736 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:52:50.919 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__get_Item_0
2023-11-20 15:52:51.057 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:52:51.075 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_Currencies_CurrencyId". The conflict occurred in database "WalletApp", table "dbo.Currencies", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b427dea9-d920-4f43-a4e7-a38663cb8fb9
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_Currencies_CurrencyId". The conflict occurred in database "WalletApp", table "dbo.Currencies", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b427dea9-d920-4f43-a4e7-a38663cb8fb9
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-20 15:52:51.265 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 522.9851ms
2023-11-20 15:52:51.267 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:52:51.336 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Transactions_Currencies_CurrencyId". The conflict occurred in database "WalletApp", table "dbo.Currencies", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b427dea9-d920-4f43-a4e7-a38663cb8fb9
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WalletApp.Persistence.Repositories.TransactionRepository.SaveAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\TransactionRepository.cs:line 22
   at WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandHandler.Handle(AddUserTransactionCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Transaction\AddUserTransaction\AddUserTransactionCommandHandler.cs:line 42
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 17
   at WalletApp.Controllers.TransactionController.AddUserTransaction(AddUserTransactionCommandDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\TransactionController.cs:line 38
   at lambda_method180(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at WalletApp.Middleware.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Middleware\AuthorizationMiddlewareResultHandler.cs:line 39
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-20 15:52:51.365 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218 - 500 - text/plain;+charset=utf-8 880.1207ms
2023-11-20 15:53:18.899 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:53:19.046 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:53:19.053 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:53:19.054 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:53:19.055 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:53:19.056 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:53:19.057 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:53:19.058 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:53:19.068 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:53:19.071 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:53:19.164 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:53:19.165 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:53:19.203 +01:00 [INF] Hosting environment: Development
2023-11-20 15:53:19.204 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:53:19.208 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:53:19.394 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:53:19.398 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:53:19.494 +01:00 [INF] Received HTTP response headers after 91.9232ms - 200
2023-11-20 15:53:19.550 +01:00 [INF] End processing HTTP request after 160.0281ms - 200
2023-11-20 15:53:20.917 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:53:21.117 +01:00 [INF] Executed DbCommand (23ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 15:53:23.653 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/currency - -
2023-11-20 15:53:23.701 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:53:23.874 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.CurrencyController.GetCurrencies (WalletApp.Api)'
2023-11-20 15:53:23.890 +01:00 [INF] Route matched with {action = "GetCurrencies", controller = "Currency"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[System.Collections.Generic.List`1[WalletApp.Application.Common.Currency.GetCurrency.GetCurrenciesQueryResponseDto]]]] GetCurrencies(System.Threading.CancellationToken) on controller WalletApp.Controllers.CurrencyController (WalletApp.Api).
2023-11-20 15:53:23.921 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:53:23.934 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[System.Collections.Generic.List`1[[WalletApp.Application.Common.Currency.GetCurrency.GetCurrenciesQueryResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-20 15:53:23.978 +01:00 [INF] Executed action WalletApp.Controllers.CurrencyController.GetCurrencies (WalletApp.Api) in 83.4747ms
2023-11-20 15:53:23.981 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.CurrencyController.GetCurrencies (WalletApp.Api)'
2023-11-20 15:53:23.993 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/currency - - - 200 - application/json;+charset=utf-8 341.4225ms
2023-11-20 15:53:37.633 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218
2023-11-20 15:53:37.642 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:53:37.647 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:53:37.822 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__get_Item_0
2023-11-20 15:53:37.961 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:53:37.970 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-20 15:53:37.972 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 323.7965ms
2023-11-20 15:53:37.973 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:53:37.975 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 218 - 200 - application/json;+charset=utf-8 341.4302ms
2023-11-20 15:55:34.725 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 214
2023-11-20 15:55:34.729 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:55:34.730 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:55:34.739 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__get_Item_0
2023-11-20 15:55:34.751 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:55:34.754 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-20 15:55:34.755 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 22.972ms
2023-11-20 15:55:34.756 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:55:34.757 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 214 - 200 - application/json;+charset=utf-8 33.8580ms
2023-11-20 15:56:55.975 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 15:56:56.112 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 15:56:56.113 +01:00 [INF] Quartz Scheduler created
2023-11-20 15:56:56.114 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 15:56:56.115 +01:00 [INF] RAMJobStore initialized.
2023-11-20 15:56:56.117 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 15:56:56.118 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 15:56:56.119 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 15:56:56.128 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 15:56:56.131 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 15:56:56.213 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 15:56:56.215 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 15:56:56.221 +01:00 [INF] Hosting environment: Development
2023-11-20 15:56:56.222 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 15:56:56.225 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 15:56:56.411 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:56:56.414 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 15:56:56.499 +01:00 [INF] Received HTTP response headers after 82.7074ms - 200
2023-11-20 15:56:56.504 +01:00 [INF] End processing HTTP request after 99.7368ms - 200
2023-11-20 15:56:57.809 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 15:56:57.990 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 15:57:34.883 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213
2023-11-20 15:57:34.923 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 15:57:35.095 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:57:35.110 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:57:35.275 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:57:35.290 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-20 15:57:35.308 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 193.0481ms
2023-11-20 15:57:35.311 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:57:35.320 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213 - 200 - application/json;+charset=utf-8 438.4999ms
2023-11-20 15:59:51.447 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213
2023-11-20 15:59:51.456 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:59:51.463 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 15:59:51.493 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 15:59:51.496 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-20 15:59:51.498 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 33.6203ms
2023-11-20 15:59:51.499 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 15:59:51.500 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213 - 200 - application/json;+charset=utf-8 52.9599ms
2023-11-20 16:00:45.555 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 16:00:45.687 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 16:00:45.689 +01:00 [INF] Quartz Scheduler created
2023-11-20 16:00:45.690 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 16:00:45.690 +01:00 [INF] RAMJobStore initialized.
2023-11-20 16:00:45.691 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 16:00:45.692 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 16:00:45.693 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 16:00:45.702 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 16:00:45.705 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 16:00:45.784 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 16:00:45.785 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 16:00:45.789 +01:00 [INF] Hosting environment: Development
2023-11-20 16:00:45.790 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 16:00:45.793 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 16:00:45.945 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:00:45.948 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:00:46.037 +01:00 [INF] Received HTTP response headers after 85.6962ms - 200
2023-11-20 16:00:46.043 +01:00 [INF] End processing HTTP request after 101.6775ms - 200
2023-11-20 16:00:47.253 +01:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 16:00:47.435 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 16:00:52.491 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 63
2023-11-20 16:00:52.538 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 16:00:52.582 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-20 16:00:52.597 +01:00 [INF] Route matched with {action = "Authentication", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto]]] Authentication(WalletApp.Application.Account.Authenticate.AuthenticateDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-20 16:00:52.744 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-20 16:00:52.758 +01:00 [INF] Executing NotFoundObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-20 16:00:52.780 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Authentication (WalletApp.Api) in 178.0692ms
2023-11-20 16:00:52.782 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-20 16:00:52.792 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 63 - 404 - application/json;+charset=utf-8 302.7005ms
2023-11-20 16:27:11.659 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 16:27:11.802 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 16:27:11.803 +01:00 [INF] Quartz Scheduler created
2023-11-20 16:27:11.804 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 16:27:11.804 +01:00 [INF] RAMJobStore initialized.
2023-11-20 16:27:11.805 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 16:27:11.806 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 16:27:11.807 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 16:27:11.816 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 16:27:11.819 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 16:27:11.910 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 16:27:11.911 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 16:27:11.916 +01:00 [INF] Hosting environment: Development
2023-11-20 16:27:11.916 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 16:27:11.919 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 16:27:12.106 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:27:12.109 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:27:12.206 +01:00 [INF] Received HTTP response headers after 93.7708ms - 200
2023-11-20 16:27:12.211 +01:00 [INF] End processing HTTP request after 108.9522ms - 200
2023-11-20 16:27:13.523 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 16:27:13.708 +01:00 [INF] Executed DbCommand (24ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 16:27:25.940 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 63
2023-11-20 16:27:25.986 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 16:27:26.050 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-20 16:27:26.067 +01:00 [INF] Route matched with {action = "Authentication", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto]]] Authentication(WalletApp.Application.Account.Authenticate.AuthenticateDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-20 16:27:26.230 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-20 16:27:26.243 +01:00 [INF] Executing NotFoundObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-20 16:27:26.264 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Authentication (WalletApp.Api) in 191.069ms
2023-11-20 16:27:26.267 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-20 16:27:26.277 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 63 - 404 - application/json;+charset=utf-8 338.5128ms
2023-11-20 16:27:32.015 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213
2023-11-20 16:27:32.128 +01:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '20.11.2023 15:12:44', Current time: '20.11.2023 15:27:32'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateJWS(String token, TokenValidationParameters validationParameters, BaseConfiguration currentConfiguration, SecurityToken& signatureValidatedToken, ExceptionDispatchInfo& exceptionThrown)
--- End of stack trace from previous location ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, JwtSecurityToken outerToken, TokenValidationParameters validationParameters, SecurityToken& signatureValidatedToken)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2023-11-20 16:27:32.137 +01:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '20.11.2023 15:12:44', Current time: '20.11.2023 15:27:32'.
2023-11-20 16:27:32.144 +01:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2023-11-20 16:27:32.168 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213 - 401 - application/json 152.4076ms
2023-11-20 16:27:38.440 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67
2023-11-20 16:27:38.442 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-20 16:27:38.444 +01:00 [INF] Route matched with {action = "Authentication", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto]]] Authentication(WalletApp.Application.Account.Authenticate.AuthenticateDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-20 16:27:38.477 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-20 16:27:38.662 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__user_Id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2023-11-20 16:27:38.695 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2023-11-20 16:27:38.717 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2023-11-20 16:27:38.723 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-20 16:27:38.729 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2023-11-20 16:27:38.770 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Guid), @__ipAddress_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [t].[Id], [t].[IpAddress], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[UserIdentityId]
FROM [Tokens] AS [t]
WHERE [t].[UserIdentityId] = @__userId_0 AND [t].[IpAddress] = @__ipAddress_1
2023-11-20 16:27:38.806 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-20 16:27:38.865 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p15='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p16='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Int32), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 256), @p8='?' (Size = 256), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 256), @p19='?' (DbType = Guid), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [IconType] = @p4, [LockoutEnabled] = @p5, [LockoutEnd] = @p6, [NormalizedEmail] = @p7, [NormalizedUserName] = @p8, [PasswordHash] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [SecurityStamp] = @p12, [TwoFactorEnabled] = @p13, [UserName] = @p14
OUTPUT 1
WHERE [Id] = @p15 AND [ConcurrencyStamp] = @p16;
UPDATE [Tokens] SET [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18
OUTPUT 1
WHERE [Id] = @p19;
2023-11-20 16:27:38.882 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-20 16:27:38.891 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Authentication (WalletApp.Api) in 445.0124ms
2023-11-20 16:27:38.892 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-20 16:27:38.894 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67 - 200 - application/json;+charset=utf-8 454.3108ms
2023-11-20 16:27:56.466 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213
2023-11-20 16:27:56.478 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 16:27:56.481 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 16:27:56.593 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 7), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Guid), @p6='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Boolean), @p11='?' (DbType = Guid), @p12='?' (DbType = DateTime2), @p13='?' (Precision = 15) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 7), @p15='?' (Size = 50), @p16='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Transactions] ([Id], [BackgroundColor], [CategoryId], [CratedBy], [CreatedTime], [CurrencyId], [Date], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Price], [TextColor], [Title], [UserIdentityId])
OUTPUT INSERTED.[IsDefault]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2023-11-20 16:27:56.602 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-20 16:27:56.604 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 120.9369ms
2023-11-20 16:27:56.605 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 16:27:56.606 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213 - 200 - application/json;+charset=utf-8 140.0267ms
2023-11-20 16:29:16.813 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 16:29:16.956 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 16:29:16.957 +01:00 [INF] Quartz Scheduler created
2023-11-20 16:29:16.958 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 16:29:16.959 +01:00 [INF] RAMJobStore initialized.
2023-11-20 16:29:16.960 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 16:29:16.961 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 16:29:16.962 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 16:29:16.970 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 16:29:16.973 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 16:29:17.061 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 16:29:17.063 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 16:29:17.067 +01:00 [INF] Hosting environment: Development
2023-11-20 16:29:17.068 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 16:29:17.070 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 16:32:12.477 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 16:32:12.624 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 16:32:12.625 +01:00 [INF] Quartz Scheduler created
2023-11-20 16:32:12.625 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 16:32:12.626 +01:00 [INF] RAMJobStore initialized.
2023-11-20 16:32:12.627 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 16:32:12.628 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 16:32:12.629 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 16:32:12.637 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 16:32:12.641 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 16:32:12.733 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 16:32:12.734 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 16:32:12.739 +01:00 [INF] Hosting environment: Development
2023-11-20 16:32:12.740 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 16:32:12.742 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 16:32:24.597 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:32:24.601 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:32:24.700 +01:00 [INF] Received HTTP response headers after 96.5668ms - 200
2023-11-20 16:32:24.704 +01:00 [INF] End processing HTTP request after 111.7595ms - 200
2023-11-20 16:32:25.947 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 16:32:26.120 +01:00 [INF] Executed DbCommand (23ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 16:32:29.768 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213
2023-11-20 16:32:29.811 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 16:32:30.008 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 16:32:30.027 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 16:32:32.580 +01:00 [INF] Executed action WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api) in 2547.2261ms
2023-11-20 16:32:32.582 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 16:32:32.599 +01:00 [ERR] An unhandled exception has occurred while executing the request.
FluentValidation.ValidationException: Validation failed: 
 -- Title: Długość pola 'Title' musi być większa lub równa 3 znaki(ów). Wprowadzono 1 znaki(ów). Severity: Error
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 27
   at WalletApp.Controllers.TransactionController.AddUserTransaction(AddUserTransactionCommandDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\TransactionController.cs:line 38
   at lambda_method180(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at WalletApp.Middleware.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Middleware\AuthorizationMiddlewareResultHandler.cs:line 39
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-20 16:32:32.623 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213 - 500 - text/plain;+charset=utf-8 2856.0793ms
2023-11-20 16:41:03.497 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 16:41:03.647 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 16:41:03.648 +01:00 [INF] Quartz Scheduler created
2023-11-20 16:41:03.649 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 16:41:03.650 +01:00 [INF] RAMJobStore initialized.
2023-11-20 16:41:03.652 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 16:41:03.652 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 16:41:03.653 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 16:41:03.662 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 16:41:03.664 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 16:41:03.755 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 16:41:03.756 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 16:41:03.760 +01:00 [INF] Hosting environment: Development
2023-11-20 16:41:03.761 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 16:41:03.763 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 16:42:31.975 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:42:31.977 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:42:32.075 +01:00 [INF] Received HTTP response headers after 95.1201ms - 200
2023-11-20 16:42:32.079 +01:00 [INF] End processing HTTP request after 108.0533ms - 200
2023-11-20 16:42:33.322 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 16:42:33.500 +01:00 [INF] Executed DbCommand (23ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 16:42:41.527 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213
2023-11-20 16:42:41.581 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 16:42:41.779 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 16:42:41.798 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
2023-11-20 16:47:42.642 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-20 16:47:42.786 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-20 16:47:42.789 +01:00 [INF] Quartz Scheduler created
2023-11-20 16:47:42.790 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-20 16:47:42.791 +01:00 [INF] RAMJobStore initialized.
2023-11-20 16:47:42.792 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-20 16:47:42.792 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-20 16:47:42.793 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-20 16:47:42.802 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-20 16:47:42.805 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-20 16:47:42.895 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-20 16:47:42.896 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-20 16:47:42.900 +01:00 [INF] Hosting environment: Development
2023-11-20 16:47:42.901 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-20 16:47:42.905 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-20 16:47:43.072 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:47:43.074 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-20 16:47:43.174 +01:00 [INF] Received HTTP response headers after 96.608ms - 200
2023-11-20 16:47:43.179 +01:00 [INF] End processing HTTP request after 111.5261ms - 200
2023-11-20 16:47:44.413 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-20 16:47:44.589 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p1='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p7='?' (DbType = Guid), @p4='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p5='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p6='?' (DbType = DateTime2), @p11='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p9='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p14='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 3) (DbType = Decimal), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Currencies] SET [Ask] = @p0, [Bid] = @p1, [ModifiedTime] = @p2
OUTPUT 1
WHERE [Id] = @p3;
UPDATE [Currencies] SET [Ask] = @p4, [Bid] = @p5, [ModifiedTime] = @p6
OUTPUT 1
WHERE [Id] = @p7;
UPDATE [Currencies] SET [Ask] = @p8, [Bid] = @p9, [ModifiedTime] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Currencies] SET [Bid] = @p12, [ModifiedTime] = @p13
OUTPUT 1
WHERE [Id] = @p14;
2023-11-20 16:47:56.365 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/transaction/addUserTransaction application/json 213
2023-11-20 16:47:56.408 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-20 16:47:56.595 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.TransactionController.AddUserTransaction (WalletApp.Api)'
2023-11-20 16:47:56.612 +01:00 [INF] Route matched with {action = "AddUserTransaction", controller = "Transaction"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] AddUserTransaction(WalletApp.Application.Common.Transaction.AddUserTransaction.AddUserTransactionCommandDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.TransactionController (WalletApp.Api).
