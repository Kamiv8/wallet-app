2023-11-22 10:48:13.830 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-22 10:48:13.884 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-22 10:48:13.888 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-22 10:48:13.892 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-22 10:48:13.918 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2023-11-22 10:48:13.936 +01:00 [INF] Applying migration '20231122094733_email_veri'.
2023-11-22 10:48:14.027 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Categories]
WHERE [Id] = '78adf0ca-9d91-4f95-8ebe-803133056425';
SELECT @@ROWCOUNT;
2023-11-22 10:48:14.059 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '5abc9602-4079-480b-89b9-49a1aca75cd8';
SELECT @@ROWCOUNT;
2023-11-22 10:48:14.065 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = '636a6aa2-04c7-4729-9b3b-acc26748c576';
SELECT @@ROWCOUNT;
2023-11-22 10:48:14.073 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = 'd477eede-7883-466e-9100-2548f1f6afc7';
SELECT @@ROWCOUNT;
2023-11-22 10:48:14.080 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM [Currencies]
WHERE [Id] = 'f608d049-bc63-4018-9f73-2f63ed709bac';
SELECT @@ROWCOUNT;
2023-11-22 10:48:14.107 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'GroupId', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name', N'UserIdentityId') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] ON;
INSERT INTO [Categories] ([Id], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [GroupId], [IsDeleted], [ModifiedBy], [ModifiedTime], [Name], [UserIdentityId])
VALUES ('fce4de9f-45af-42f9-98b9-94b602d88238', NULL, NULL, NULL, NULL, NULL, CAST(0 AS bit), NULL, NULL, N'Rachunki', NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'GroupId', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name', N'UserIdentityId') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] OFF;
2023-11-22 10:48:14.127 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Ask', N'Bid', N'Code', N'CratedBy', N'CreatedTime', N'CurrencyName', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'TradingDate') AND [object_id] = OBJECT_ID(N'[Currencies]'))
    SET IDENTITY_INSERT [Currencies] ON;
INSERT INTO [Currencies] ([Id], [Ask], [Bid], [Code], [CratedBy], [CreatedTime], [CurrencyName], [DeletedBy], [DeletedTime], [IsDeleted], [ModifiedBy], [ModifiedTime], [TradingDate])
VALUES ('142169e3-2c32-46ec-8c6d-773e0768deb4', 4.055, 3.972, N'CHF', NULL, NULL, N'frank szwajcarski', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-22T10:47:32.8801420+01:00'),
('c0b84ee7-9845-4f07-87e6-dfd18148915f', 4.055, 3.972, N'EUR', NULL, NULL, N'euro', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-22T10:47:32.8801416+01:00'),
('dcce1c57-4eb0-44cc-b3e2-2060321842b2', 4.055, 3.972, N'USD', NULL, NULL, N'dolar amerykanski', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-22T10:47:32.8801363+01:00'),
('ede48a0c-6b70-46a8-a323-0433bc8a03a0', 4.055, 3.972, N'GBP', NULL, NULL, N'funt szterling', NULL, NULL, CAST(0 AS bit), NULL, NULL, '2023-11-22T10:47:32.8801423+01:00');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Ask', N'Bid', N'Code', N'CratedBy', N'CreatedTime', N'CurrencyName', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'TradingDate') AND [object_id] = OBJECT_ID(N'[Currencies]'))
    SET IDENTITY_INSERT [Currencies] OFF;
2023-11-22 10:48:14.131 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20231122094733_email_veri', N'7.0.12');
2023-11-22 12:24:44.096 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-22 12:24:44.277 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-22 12:24:44.287 +01:00 [INF] Quartz Scheduler created
2023-11-22 12:24:44.288 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-22 12:24:44.289 +01:00 [INF] RAMJobStore initialized.
2023-11-22 12:24:44.290 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-22 12:24:44.291 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-22 12:24:44.292 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-22 12:24:44.306 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-22 12:24:44.309 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-22 12:24:44.427 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-22 12:24:44.429 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-22 12:24:44.435 +01:00 [INF] Hosting environment: Development
2023-11-22 12:24:44.436 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-22 12:24:44.438 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-22 12:24:44.652 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 12:24:44.655 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 12:24:44.787 +01:00 [INF] Received HTTP response headers after 127.5434ms - 200
2023-11-22 12:24:44.792 +01:00 [INF] End processing HTTP request after 144.0302ms - 200
2023-11-22 12:24:46.316 +01:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-22 12:24:46.567 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-22 12:24:46.580 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-22 12:25:20.771 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 12:25:20.819 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-22 12:25:20.904 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 12:25:20.925 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 12:25:21.210 +01:00 [INF] Executed DbCommand (54ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 12:25:21.465 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 12:25:28.490 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 12:25:28.518 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 7586.6743ms
2023-11-22 12:25:28.521 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 12:25:28.532 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 200 - application/json;+charset=utf-8 7762.9509ms
2023-11-22 12:53:56.623 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-22 12:53:56.784 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-22 12:53:56.785 +01:00 [INF] Quartz Scheduler created
2023-11-22 12:53:56.786 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-22 12:53:56.787 +01:00 [INF] RAMJobStore initialized.
2023-11-22 12:53:56.788 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-22 12:53:56.789 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-22 12:53:56.790 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-22 12:53:56.799 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-22 12:53:56.802 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-22 12:53:56.899 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-22 12:53:56.900 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-22 12:53:56.905 +01:00 [INF] Hosting environment: Development
2023-11-22 12:53:56.905 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-22 12:53:56.908 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-22 12:53:57.078 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 12:53:57.081 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 12:53:57.180 +01:00 [INF] Received HTTP response headers after 96.2856ms - 200
2023-11-22 12:53:57.185 +01:00 [INF] End processing HTTP request after 110.7278ms - 200
2023-11-22 12:53:58.441 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-22 12:53:58.667 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-22 12:53:58.677 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-22 12:54:23.114 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 12:54:23.160 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-22 12:54:23.230 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 12:54:23.245 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 12:54:23.516 +01:00 [INF] Executed DbCommand (24ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 12:54:23.712 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 12:54:29.069 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 12:54:29.090 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 5839.7953ms
2023-11-22 12:54:29.095 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 12:54:29.104 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 200 - application/json;+charset=utf-8 5992.3678ms
2023-11-22 12:55:23.574 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 12:55:23.582 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 12:55:23.583 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 12:55:23.614 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 12:55:23.692 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 12:55:30.381 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 12:55:30.383 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 6797.6115ms
2023-11-22 12:55:30.384 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 12:55:30.386 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 200 - application/json;+charset=utf-8 6811.7354ms
2023-11-22 12:55:38.080 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 12:55:38.081 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 12:55:38.082 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 12:55:38.093 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 12:55:38.165 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 12:56:40.716 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 12:56:40.721 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 62637.1687ms
2023-11-22 12:56:40.722 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 12:56:40.723 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 200 - application/json;+charset=utf-8 62643.6051ms
2023-11-22 13:42:40.649 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-22 13:42:40.799 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-22 13:42:40.800 +01:00 [INF] Quartz Scheduler created
2023-11-22 13:42:40.802 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-22 13:42:40.803 +01:00 [INF] RAMJobStore initialized.
2023-11-22 13:42:40.804 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-22 13:42:40.805 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-22 13:42:40.806 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-22 13:42:40.817 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-22 13:42:40.820 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-22 13:42:40.914 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-22 13:42:40.915 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-22 13:42:40.920 +01:00 [INF] Hosting environment: Development
2023-11-22 13:42:40.921 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-22 13:42:40.924 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-22 13:42:41.110 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 13:42:41.113 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 13:42:41.211 +01:00 [INF] Received HTTP response headers after 94.9119ms - 200
2023-11-22 13:42:41.215 +01:00 [INF] End processing HTTP request after 110.0438ms - 200
2023-11-22 13:42:42.537 +01:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-22 13:42:42.759 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-22 13:42:42.770 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-22 13:43:02.542 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-22 13:43:02.690 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-22 13:43:02.691 +01:00 [INF] Quartz Scheduler created
2023-11-22 13:43:02.693 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-22 13:43:02.693 +01:00 [INF] RAMJobStore initialized.
2023-11-22 13:43:02.695 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-22 13:43:02.696 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-22 13:43:02.697 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-22 13:43:02.706 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-22 13:43:02.709 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-22 13:43:02.796 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-22 13:43:02.798 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-22 13:43:02.803 +01:00 [INF] Hosting environment: Development
2023-11-22 13:43:02.804 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-22 13:43:02.806 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-22 13:43:02.981 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 13:43:02.984 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 13:43:03.081 +01:00 [INF] Received HTTP response headers after 93.0714ms - 200
2023-11-22 13:43:03.085 +01:00 [INF] End processing HTTP request after 109.0671ms - 200
2023-11-22 13:43:04.383 +01:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-22 13:43:04.617 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-22 13:43:04.628 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-22 13:44:18.911 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 13:44:18.953 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-22 13:44:19.014 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 13:44:19.029 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 13:44:19.259 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 13:44:19.446 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 13:44:23.835 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 4800.1318ms
2023-11-22 13:44:23.838 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 13:44:23.841 +01:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null. (Parameter 'apiKey')
   at Mailjet.Client.MailjetClientExtensions.UseBasicAuthentication(HttpClient client, String apiKey, String apiSecret)
   at Mailjet.Client.MailjetClient..ctor(String apiKey, String apiSecret, HttpMessageHandler httpMessageHandler)
   at WalletApp.Infractructure.EmailClient.EmailClient.SendMailAsync(EmailClientDto dto) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\EmailClient\EmailClient.cs:line 24
   at WalletApp.Application.Common.Account.Register.RegisterCommandHandler.Handle(RegisterCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Account\Register\RegisterCommandHandler.cs:line 50
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 39
   at WalletApp.Controllers.AccountController.Register(RegisterDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\AccountController.cs:line 45
   at lambda_method183(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-22 13:44:23.864 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 500 - text/plain;+charset=utf-8 4954.5571ms
2023-11-22 13:45:05.400 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-22 13:45:05.551 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-22 13:45:05.552 +01:00 [INF] Quartz Scheduler created
2023-11-22 13:45:05.553 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-22 13:45:05.554 +01:00 [INF] RAMJobStore initialized.
2023-11-22 13:45:05.555 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-22 13:45:05.556 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-22 13:45:05.557 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-22 13:45:05.566 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-22 13:45:05.569 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-22 13:45:05.664 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-22 13:45:05.665 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-22 13:45:05.669 +01:00 [INF] Hosting environment: Development
2023-11-22 13:45:05.670 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-22 13:45:05.672 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-22 13:45:05.849 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 13:45:05.852 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 13:45:05.952 +01:00 [INF] Received HTTP response headers after 97.107ms - 200
2023-11-22 13:45:05.957 +01:00 [INF] End processing HTTP request after 112.1396ms - 200
2023-11-22 13:45:07.266 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-22 13:45:07.491 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-22 13:45:07.505 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-22 13:45:12.044 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 13:45:12.085 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-22 13:45:12.144 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 13:45:12.160 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 13:45:12.380 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 13:45:12.571 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 13:45:15.523 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 13:45:15.542 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 3377.1138ms
2023-11-22 13:45:15.546 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 13:45:15.557 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 200 - application/json;+charset=utf-8 3514.3048ms
2023-11-22 13:46:00.933 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 13:46:00.937 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 13:46:00.939 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 13:46:00.969 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 13:46:01.043 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 13:50:05.688 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 13:50:05.690 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 244749.5454ms
2023-11-22 13:50:05.692 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 13:50:05.694 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 200 - application/json;+charset=utf-8 244761.0221ms
2023-11-22 14:07:22.459 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-22 14:07:22.611 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-22 14:07:22.613 +01:00 [INF] Quartz Scheduler created
2023-11-22 14:07:22.614 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-22 14:07:22.614 +01:00 [INF] RAMJobStore initialized.
2023-11-22 14:07:22.615 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-22 14:07:22.616 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-22 14:07:22.617 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-22 14:07:22.627 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-22 14:07:22.630 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-22 14:07:22.723 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-22 14:07:22.724 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-22 14:07:22.728 +01:00 [INF] Hosting environment: Development
2023-11-22 14:07:22.729 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-22 14:07:22.732 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-22 14:07:22.903 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 14:07:22.906 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-22 14:07:23.014 +01:00 [INF] Received HTTP response headers after 105.1715ms - 200
2023-11-22 14:07:23.019 +01:00 [INF] End processing HTTP request after 120.6942ms - 200
2023-11-22 14:07:24.438 +01:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-22 14:07:24.681 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-22 14:07:24.692 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-22 14:07:55.964 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 14:07:56.013 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-22 14:07:56.086 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 14:07:56.104 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 14:07:56.342 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 14:07:56.549 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 14:08:11.326 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 14:08:11.346 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 15235.6824ms
2023-11-22 14:08:11.348 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 14:08:11.360 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 200 - application/json;+charset=utf-8 15397.9674ms
2023-11-22 14:13:34.054 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167
2023-11-22 14:13:34.058 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 14:13:34.060 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 14:13:34.099 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 14:13:34.184 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 14:13:34.304 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 14:13:34.305 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 243.9335ms
2023-11-22 14:13:34.306 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 14:13:34.308 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 167 - 200 - application/json;+charset=utf-8 253.2512ms
2023-11-22 14:15:56.193 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 170
2023-11-22 14:15:56.196 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 14:15:56.197 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-22 14:15:56.206 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-22 14:15:56.280 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-22 14:15:56.390 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-22 14:15:56.391 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 192.937ms
2023-11-22 14:15:56.393 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-22 14:15:56.394 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 170 - 200 - application/json;+charset=utf-8 203.8990ms
