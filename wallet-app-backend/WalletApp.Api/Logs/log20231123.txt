2023-11-23 20:04:02.613 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 20:04:02.823 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 20:04:02.825 +01:00 [INF] Quartz Scheduler created
2023-11-23 20:04:02.827 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 20:04:02.838 +01:00 [INF] RAMJobStore initialized.
2023-11-23 20:04:02.840 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 20:04:02.841 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 20:04:02.842 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 20:04:02.854 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 20:04:02.857 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 20:04:02.963 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 20:04:02.964 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 20:04:02.969 +01:00 [INF] Hosting environment: Development
2023-11-23 20:04:02.970 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 20:04:02.973 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 20:04:03.197 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 20:04:03.200 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 20:04:03.365 +01:00 [INF] Received HTTP response headers after 161.2019ms - 200
2023-11-23 20:04:03.370 +01:00 [INF] End processing HTTP request after 179.1759ms - 200
2023-11-23 20:04:05.235 +01:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-23 20:04:05.562 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-23 20:04:05.576 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-23 20:04:18.386 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67
2023-11-23 20:04:18.426 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-23 20:04:18.490 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-23 20:04:18.506 +01:00 [INF] Route matched with {action = "Authentication", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto]]] Authentication(WalletApp.Application.Account.Authenticate.AuthenticateDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-23 20:04:18.709 +01:00 [INF] Executed DbCommand (25ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-23 20:04:18.762 +01:00 [INF] Executing NotFoundObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-23 20:04:18.798 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Authentication (WalletApp.Api) in 285.1765ms
2023-11-23 20:04:18.801 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-23 20:04:18.814 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67 - 404 - application/json;+charset=utf-8 428.3415ms
2023-11-23 20:04:40.501 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67
2023-11-23 20:04:40.506 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-23 20:04:40.509 +01:00 [INF] Route matched with {action = "Authentication", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto]]] Authentication(WalletApp.Application.Account.Authenticate.AuthenticateDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-23 20:04:44.386 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-23 20:04:55.453 +01:00 [INF] Executing NotFoundObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-23 20:04:55.455 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Authentication (WalletApp.Api) in 14944.0867ms
2023-11-23 20:04:55.456 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-23 20:04:55.457 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67 - 404 - application/json;+charset=utf-8 14955.6972ms
2023-11-23 20:09:41.206 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 20:09:41.350 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 20:09:41.351 +01:00 [INF] Quartz Scheduler created
2023-11-23 20:09:41.352 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 20:09:41.353 +01:00 [INF] RAMJobStore initialized.
2023-11-23 20:09:41.354 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 20:09:41.355 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 20:09:41.356 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 20:09:41.364 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 20:09:41.368 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 20:09:41.456 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 20:09:41.458 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 20:09:41.463 +01:00 [INF] Hosting environment: Development
2023-11-23 20:09:41.463 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 20:09:41.466 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 20:09:41.640 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 20:09:41.643 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 20:09:41.806 +01:00 [INF] Received HTTP response headers after 160.2221ms - 200
2023-11-23 20:09:41.810 +01:00 [INF] End processing HTTP request after 174.9873ms - 200
2023-11-23 20:09:43.190 +01:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-23 20:09:43.420 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-23 20:09:43.431 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-23 20:09:50.987 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67
2023-11-23 20:09:51.031 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-23 20:09:51.089 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-23 20:09:51.110 +01:00 [INF] Route matched with {action = "Authentication", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult`1[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto]]] Authentication(WalletApp.Application.Account.Authenticate.AuthenticateDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-23 20:09:54.387 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-23 20:09:54.585 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__user_Id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2023-11-23 20:09:54.618 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2023-11-23 20:09:54.633 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2023-11-23 20:10:01.831 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-23 20:10:01.838 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2023-11-23 20:10:01.944 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Guid), @__ipAddress_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [t].[Id], [t].[IpAddress], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[UserIdentityId]
FROM [Tokens] AS [t]
WHERE [t].[UserIdentityId] = @__userId_0 AND [t].[IpAddress] = @__ipAddress_1
2023-11-23 20:10:01.968 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-23 20:10:02.085 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p15='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p16='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Int32), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 256), @p8='?' (Size = 256), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 256), @p19='?' (DbType = Guid), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [IconType] = @p4, [LockoutEnabled] = @p5, [LockoutEnd] = @p6, [NormalizedEmail] = @p7, [NormalizedUserName] = @p8, [PasswordHash] = @p9, [PhoneNumber] = @p10, [PhoneNumberConfirmed] = @p11, [SecurityStamp] = @p12, [TwoFactorEnabled] = @p13, [UserName] = @p14
OUTPUT 1
WHERE [Id] = @p15 AND [ConcurrencyStamp] = @p16;
UPDATE [Tokens] SET [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18
OUTPUT 1
WHERE [Id] = @p19;
2023-11-23 20:10:02.124 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult`1[[WalletApp.Application.Account.Authenticate.AuthenticateResponseDto, WalletApp.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-23 20:10:02.151 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Authentication (WalletApp.Api) in 11034.9041ms
2023-11-23 20:10:02.154 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-23 20:10:02.166 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 67 - 200 - application/json;+charset=utf-8 11182.6664ms
2023-11-23 22:26:55.801 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 22:26:56.012 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 22:26:56.013 +01:00 [INF] Quartz Scheduler created
2023-11-23 22:26:56.014 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 22:26:56.016 +01:00 [INF] RAMJobStore initialized.
2023-11-23 22:26:56.017 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 22:26:56.018 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 22:26:56.019 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 22:26:56.032 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 22:26:56.036 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 22:26:56.177 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 22:26:56.179 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 22:26:56.185 +01:00 [INF] Hosting environment: Development
2023-11-23 22:26:56.186 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 22:26:56.188 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 22:26:56.376 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 22:26:56.380 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 22:26:56.512 +01:00 [INF] Received HTTP response headers after 128.9358ms - 200
2023-11-23 22:26:56.518 +01:00 [INF] End processing HTTP request after 146.3679ms - 200
2023-11-23 22:26:58.000 +01:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-23 22:26:58.234 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-23 22:26:58.247 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-23 22:28:11.906 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 170
2023-11-23 22:28:11.949 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-23 22:28:12.015 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-23 22:28:12.034 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-23 22:28:12.289 +01:00 [INF] Executed DbCommand (28ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-23 22:28:12.495 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-23 22:28:12.836 +01:00 [INF] Executing OkObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-23 22:28:12.859 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 818.998ms
2023-11-23 22:28:12.863 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-23 22:28:12.875 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 170 - 200 - application/json;+charset=utf-8 969.9398ms
2023-11-23 22:29:36.671 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/account/confirmEmail?token=CfDJ8EiDzhv42rJMjuU8wUYDlz/R+K2z1t6sXxBEqp/PJ4Wd0BFrbZGbhIUyT5muOk1YziPC4kmqUEtXWEaq7alRVY+6xjnm+2VGD9tRAkX+S7rlDLPQyjTBLBXE54gggD3G5HVB3RUFx6EM/+SgLu99WBFvAiP182SkdVJ9Pd7s/IUchk0pFBbmCTWDxQSbQRC9i1Welk4+nf9joxA4sQ/T71VA1cd1huX6rlh94de5xS1DVt09qSbk+FcLibSuhB9Atg==&email=gryciuk1102@gmail.com - -
2023-11-23 22:29:36.678 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.EmailConfirmation (WalletApp.Api)'
2023-11-23 22:29:36.681 +01:00 [INF] Route matched with {action = "EmailConfirmation", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] EmailConfirmation(System.String, System.String, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-23 22:29:36.715 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-23 22:29:36.720 +01:00 [INF] Executing NotFoundObjectResult, writing value of type 'WalletApp.Application.Common.ApiResult'.
2023-11-23 22:29:36.723 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.EmailConfirmation (WalletApp.Api) in 40.2406ms
2023-11-23 22:29:36.724 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.EmailConfirmation (WalletApp.Api)'
2023-11-23 22:29:36.725 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/account/confirmEmail?token=CfDJ8EiDzhv42rJMjuU8wUYDlz/R+K2z1t6sXxBEqp/PJ4Wd0BFrbZGbhIUyT5muOk1YziPC4kmqUEtXWEaq7alRVY+6xjnm+2VGD9tRAkX+S7rlDLPQyjTBLBXE54gggD3G5HVB3RUFx6EM/+SgLu99WBFvAiP182SkdVJ9Pd7s/IUchk0pFBbmCTWDxQSbQRC9i1Welk4+nf9joxA4sQ/T71VA1cd1huX6rlh94de5xS1DVt09qSbk+FcLibSuhB9Atg==&email=gryciuk1102@gmail.com - - - 404 - application/json;+charset=utf-8 53.4806ms
2023-11-23 22:57:13.843 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 22:57:14.001 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 22:57:14.002 +01:00 [INF] Quartz Scheduler created
2023-11-23 22:57:14.003 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 22:57:14.004 +01:00 [INF] RAMJobStore initialized.
2023-11-23 22:57:14.005 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 22:57:14.006 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 22:57:14.007 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 22:57:14.018 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 22:57:14.021 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 22:57:14.121 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 22:57:14.123 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 22:57:14.128 +01:00 [INF] Hosting environment: Development
2023-11-23 22:57:14.129 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 22:57:14.132 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 22:57:14.330 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 22:57:14.333 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 22:57:14.465 +01:00 [INF] Received HTTP response headers after 128.1863ms - 200
2023-11-23 22:57:14.470 +01:00 [INF] End processing HTTP request after 144.7832ms - 200
2023-11-23 22:57:15.843 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-23 22:57:16.072 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-23 22:57:16.083 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-23 22:58:41.259 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 170
2023-11-23 22:58:41.300 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-23 22:58:41.361 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-23 22:58:41.377 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-23 22:58:41.589 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-23 22:58:41.810 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-23 22:58:42.205 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 823.292ms
2023-11-23 22:58:42.211 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-23 22:58:42.215 +01:00 [ERR] An unhandled exception has occurred while executing the request.
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 53
   at WalletApp.Persistence.Repositories.AccountDataRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\AccountDataRepository.cs:line 26
   at WalletApp.Application.Common.Account.Register.RegisterCommandHandler.Handle(RegisterCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Account\Register\RegisterCommandHandler.cs:line 58
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 39
   at WalletApp.Controllers.AccountController.Register(RegisterDto dto, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Controllers\AccountController.cs:line 46
   at lambda_method184(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2023-11-23 22:58:42.240 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 170 - 500 - text/plain;+charset=utf-8 981.5729ms
2023-11-23 23:00:21.090 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 23:00:21.264 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 23:00:21.266 +01:00 [INF] Quartz Scheduler created
2023-11-23 23:00:21.267 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 23:00:21.268 +01:00 [INF] RAMJobStore initialized.
2023-11-23 23:00:21.269 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 23:00:21.270 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 23:00:21.272 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 23:00:21.282 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 23:00:21.285 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 23:00:21.385 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 23:00:21.386 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 23:00:21.391 +01:00 [INF] Hosting environment: Development
2023-11-23 23:00:21.391 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 23:00:21.395 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 23:00:21.580 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:00:21.583 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:00:21.728 +01:00 [INF] Received HTTP response headers after 141.5412ms - 200
2023-11-23 23:00:21.732 +01:00 [INF] End processing HTTP request after 156.7919ms - 200
2023-11-23 23:00:23.161 +01:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-23 23:00:23.408 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-23 23:00:23.420 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-23 23:02:41.919 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 23:02:42.080 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 23:02:42.082 +01:00 [INF] Quartz Scheduler created
2023-11-23 23:02:42.083 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 23:02:42.083 +01:00 [INF] RAMJobStore initialized.
2023-11-23 23:02:42.085 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 23:02:42.085 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 23:02:42.086 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 23:02:42.095 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 23:02:42.099 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 23:02:42.199 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 23:02:42.201 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 23:02:42.206 +01:00 [INF] Hosting environment: Development
2023-11-23 23:02:42.207 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 23:02:42.209 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 23:02:42.410 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:02:42.414 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:02:42.566 +01:00 [INF] Received HTTP response headers after 147.7172ms - 200
2023-11-23 23:02:42.572 +01:00 [INF] End processing HTTP request after 165.9782ms - 200
2023-11-23 23:02:43.982 +01:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-23 23:02:44.218 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-23 23:02:44.232 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-23 23:03:19.098 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 171
2023-11-23 23:03:19.143 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-23 23:03:19.203 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-23 23:03:19.219 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Common.ApiResult]] Register(WalletApp.Application.Account.Register.RegisterDto, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-23 23:03:19.443 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2023-11-23 23:03:40.039 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[IconType], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2023-11-23 23:05:07.741 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 23:05:07.908 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 23:05:07.909 +01:00 [INF] Quartz Scheduler created
2023-11-23 23:05:07.910 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 23:05:07.911 +01:00 [INF] RAMJobStore initialized.
2023-11-23 23:05:07.912 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 23:05:07.914 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 23:05:07.915 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 23:05:07.925 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 23:05:07.929 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 23:05:08.026 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 23:05:08.028 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 23:05:08.033 +01:00 [INF] Hosting environment: Development
2023-11-23 23:05:08.034 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 23:05:08.037 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 23:05:08.240 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:05:08.243 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:05:08.380 +01:00 [INF] Received HTTP response headers after 133.1437ms - 200
2023-11-23 23:05:08.385 +01:00 [INF] End processing HTTP request after 149.4433ms - 200
2023-11-23 23:05:09.772 +01:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-23 23:05:30.446 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-23 23:05:30.451 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-23 23:13:50.656 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 23:13:50.835 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 23:13:50.836 +01:00 [INF] Quartz Scheduler created
2023-11-23 23:13:50.837 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 23:13:50.838 +01:00 [INF] RAMJobStore initialized.
2023-11-23 23:13:50.839 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 23:13:50.839 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 23:13:50.840 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 23:13:50.851 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 23:13:50.854 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 23:13:50.955 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 23:13:50.956 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 23:13:50.961 +01:00 [INF] Hosting environment: Development
2023-11-23 23:13:50.962 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 23:13:50.965 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 23:13:51.160 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:13:51.164 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:13:51.325 +01:00 [INF] Received HTTP response headers after 157.5293ms - 200
2023-11-23 23:13:51.330 +01:00 [INF] End processing HTTP request after 175.4343ms - 200
2023-11-23 23:13:52.767 +01:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
2023-11-23 23:18:52.560 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-23 23:18:52.567 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.Exception: Cannot find user form the token
   at WalletApp.Services.CurrentUserService.get_Id() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 22
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 58
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 49
   at WalletApp.Application.Common.Currency.Update.UpdateCurrencyCommandHandler.Handle(UpdateCurrencyCommand request, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Common\Currency\UpdateCurrency\UpdateCurrencyCommandHandler.cs:line 33
   at MediatR.Wrappers.RequestHandlerWrapperImpl`1.<>c__DisplayClass1_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location ---
   at WalletApp.Application.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Application\Behaviours\ValidationBehaviour.cs:line 18
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 29
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-23 23:22:54.916 +01:00 [INF] User profile is available. Using 'C:\Users\maste\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2023-11-23 23:22:55.077 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-23 23:22:55.078 +01:00 [INF] Quartz Scheduler created
2023-11-23 23:22:55.079 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-23 23:22:55.080 +01:00 [INF] RAMJobStore initialized.
2023-11-23 23:22:55.081 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-23 23:22:55.082 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-23 23:22:55.082 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-23 23:22:55.095 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-23 23:22:55.098 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-23 23:22:55.203 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-23 23:22:55.205 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-23 23:22:55.209 +01:00 [INF] Hosting environment: Development
2023-11-23 23:22:55.210 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-23 23:22:55.213 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-23 23:22:55.399 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:22:55.402 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-23 23:22:55.588 +01:00 [INF] Received HTTP response headers after 181.4076ms - 200
2023-11-23 23:22:55.592 +01:00 [INF] End processing HTTP request after 197.8275ms - 200
2023-11-23 23:22:56.985 +01:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
