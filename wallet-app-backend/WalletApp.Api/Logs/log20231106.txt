2023-11-06 18:11:03.177 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-06 18:11:03.218 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-06 18:11:03.221 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2023-11-06 18:11:03.223 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2023-11-06 18:11:03.242 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2023-11-06 18:11:03.255 +01:00 [INF] Applying migration '20231106171045_new-tables'.
2023-11-06 18:11:03.318 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Currencies] ADD [CratedBy] uniqueidentifier NULL;
2023-11-06 18:11:03.320 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Currencies] ADD [CreatedTime] datetime2 NULL;
2023-11-06 18:11:03.322 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Currencies] ADD [DeletedBy] uniqueidentifier NULL;
2023-11-06 18:11:03.323 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Currencies] ADD [DeletedTime] datetime2 NULL;
2023-11-06 18:11:03.325 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Currencies] ADD [IsDeleted] bit NOT NULL DEFAULT CAST(0 AS bit);
2023-11-06 18:11:03.327 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Currencies] ADD [ModifiedBy] uniqueidentifier NULL;
2023-11-06 18:11:03.328 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Currencies] ADD [ModifiedTime] datetime2 NULL;
2023-11-06 18:11:03.332 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AccountData] (
    [Id] uniqueidentifier NOT NULL,
    [ActualMoney] decimal(15,2) NOT NULL DEFAULT 0.0,
    [AccountId] uniqueidentifier NOT NULL,
    [CratedBy] uniqueidentifier NULL,
    [CreatedTime] datetime2 NULL,
    [ModifiedBy] uniqueidentifier NULL,
    [ModifiedTime] datetime2 NULL,
    [DeletedBy] uniqueidentifier NULL,
    [DeletedTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_AccountData] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AccountData_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2023-11-06 18:11:03.334 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] uniqueidentifier NOT NULL,
    [Name] varchar(50) NOT NULL,
    [CratedBy] uniqueidentifier NULL,
    [CreatedTime] datetime2 NULL,
    [ModifiedBy] uniqueidentifier NULL,
    [ModifiedTime] datetime2 NULL,
    [DeletedBy] uniqueidentifier NULL,
    [DeletedTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2023-11-06 18:11:03.337 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Notes] (
    [Id] uniqueidentifier NOT NULL,
    [Title] varchar(50) NOT NULL,
    [Text] varchar(500) NULL,
    [IsDone] bit NOT NULL DEFAULT CAST(0 AS bit),
    [TextColor] varchar(7) NULL,
    [BackgroundColor] varchar(7) NULL,
    [AccountId] uniqueidentifier NOT NULL,
    [CratedBy] uniqueidentifier NULL,
    [CreatedTime] datetime2 NULL,
    [ModifiedBy] uniqueidentifier NULL,
    [ModifiedTime] datetime2 NULL,
    [DeletedBy] uniqueidentifier NULL,
    [DeletedTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Notes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notes_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2023-11-06 18:11:03.340 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] uniqueidentifier NOT NULL,
    [Title] varchar(50) NOT NULL,
    [Price] decimal(15,2) NOT NULL,
    [Date] datetime2 NOT NULL,
    [TextColor] varchar(7) NULL,
    [BackgroundColor] varchar(7) NULL,
    [IsDefault] bit NOT NULL DEFAULT CAST(0 AS bit),
    [CategoryId] uniqueidentifier NOT NULL,
    [CurrencyId] uniqueidentifier NOT NULL,
    [AccountId] uniqueidentifier NOT NULL,
    [CratedBy] uniqueidentifier NULL,
    [CreatedTime] datetime2 NULL,
    [ModifiedBy] uniqueidentifier NULL,
    [ModifiedTime] datetime2 NULL,
    [DeletedBy] uniqueidentifier NULL,
    [DeletedTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_Currencies_CurrencyId] FOREIGN KEY ([CurrencyId]) REFERENCES [Currencies] ([Id]) ON DELETE CASCADE
);
2023-11-06 18:11:03.359 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] ON;
INSERT INTO [Categories] ([Id], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [IsDeleted], [ModifiedBy], [ModifiedTime], [Name])
VALUES ('13e1225f-1e67-42bc-9c4b-870060daa66b', NULL, NULL, NULL, NULL, CAST(0 AS bit), NULL, NULL, 'Rachunki');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'CratedBy', N'CreatedTime', N'DeletedBy', N'DeletedTime', N'IsDeleted', N'ModifiedBy', N'ModifiedTime', N'Name') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] OFF;
2023-11-06 18:11:03.361 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AccountData_AccountId] ON [AccountData] ([AccountId]);
2023-11-06 18:11:03.363 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notes_AccountId] ON [Notes] ([AccountId]);
2023-11-06 18:11:03.364 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_AccountId] ON [Transactions] ([AccountId]);
2023-11-06 18:11:03.365 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_CategoryId] ON [Transactions] ([CategoryId]);
2023-11-06 18:11:03.366 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_CurrencyId] ON [Transactions] ([CurrencyId]);
2023-11-06 18:11:03.368 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20231106171045_new-tables', N'7.0.12');
2023-11-06 18:23:47.978 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-06 18:23:48.004 +01:00 [INF] Quartz Scheduler created
2023-11-06 18:23:48.005 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-06 18:23:48.006 +01:00 [INF] RAMJobStore initialized.
2023-11-06 18:23:48.007 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-06 18:23:48.007 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-06 18:23:48.008 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-06 18:23:48.017 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-06 18:23:48.020 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-06 18:23:48.062 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-06 18:23:48.064 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:23:48.065 +01:00 [INF] Hosting environment: Development
2023-11-06 18:23:48.066 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-06 18:23:48.066 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-06 18:23:48.170 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:23:48.173 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:23:48.288 +01:00 [INF] Received HTTP response headers after 112.2186ms - 200
2023-11-06 18:23:48.292 +01:00 [INF] End processing HTTP request after 125.3247ms - 200
2023-11-06 18:23:48.748 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger - -
2023-11-06 18:23:48.776 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-06 18:23:48.800 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger - - - 404 0 - 54.3666ms
2023-11-06 18:23:49.305 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[@__code_0='?' (Size = 3) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
WHERE [c].[Code] = @__code_0
2023-11-06 18:23:49.416 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-06 18:23:49.425 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-06 18:24:53.953 +01:00 [INF] Application is shutting down...
2023-11-06 18:24:53.963 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED shutting down.
2023-11-06 18:24:53.965 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED paused.
2023-11-06 18:24:53.969 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED Shutdown complete.
2023-11-06 18:25:00.887 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-06 18:25:00.910 +01:00 [INF] Quartz Scheduler created
2023-11-06 18:25:00.912 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-06 18:25:00.912 +01:00 [INF] RAMJobStore initialized.
2023-11-06 18:25:00.913 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-06 18:25:00.914 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-06 18:25:00.914 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-06 18:25:00.921 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-06 18:25:00.924 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-06 18:25:00.958 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-06 18:25:00.961 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:25:00.962 +01:00 [INF] Hosting environment: Development
2023-11-06 18:25:00.963 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-06 18:25:00.963 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-06 18:25:01.068 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:25:01.071 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:25:01.178 +01:00 [INF] Received HTTP response headers after 102.8731ms - 200
2023-11-06 18:25:01.182 +01:00 [INF] End processing HTTP request after 116.4157ms - 200
2023-11-06 18:25:01.216 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger - -
2023-11-06 18:25:01.241 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-06 18:25:01.255 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger - - - 404 0 - 40.9044ms
2023-11-06 18:25:02.080 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[@__code_0='?' (Size = 3) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
WHERE [c].[Code] = @__code_0
2023-11-06 18:25:02.175 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-06 18:25:02.182 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-06 18:25:09.923 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 150
2023-11-06 18:25:09.927 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:25:09.942 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:25:10.049 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:25:10.296 +01:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (Size = 255), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = Guid), @p9='?' (DbType = DateTime2), @p10='?' (Size = 255) (DbType = AnsiString), @p11='?' (Size = 40) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Id], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [Email], [Icon], [IsDeleted], [ModifiedBy], [ModifiedTime], [PasswordHash], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
2023-11-06 18:25:10.310 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Accounts' with unique index 'IX_Accounts_Email'. The duplicate key value is (kamiv8@gmail.com).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:f8ac46b6-a8c9-480c-90a1-be2059b07515
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Accounts' with unique index 'IX_Accounts_Email'. The duplicate key value is (kamiv8@gmail.com).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__209_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:f8ac46b6-a8c9-480c-90a1-be2059b07515
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-06 18:25:10.325 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 377.5908ms
2023-11-06 18:25:10.327 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:25:10.338 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 150 - 500 - application/json 415.2512ms
2023-11-06 18:26:43.208 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/auth/register - -
2023-11-06 18:26:43.211 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:26:43.213 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/auth/register - - - 204 - - 4.0841ms
2023-11-06 18:26:43.214 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/auth/register application/json 112
2023-11-06 18:26:43.215 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:26:43.227 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/auth/register application/json 112 - 404 0 - 12.8252ms
2023-11-06 18:27:10.169 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/auth/register - -
2023-11-06 18:27:10.170 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:27:10.172 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/auth/register - - - 204 - - 2.3607ms
2023-11-06 18:27:10.172 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/auth/register application/json 112
2023-11-06 18:27:10.174 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:27:10.178 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/auth/register application/json 112 - 404 0 - 5.2854ms
2023-11-06 18:27:56.857 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/auth/register - -
2023-11-06 18:27:56.858 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:27:56.860 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/auth/register - - - 204 - - 3.7008ms
2023-11-06 18:27:56.861 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/auth/register application/json 112
2023-11-06 18:27:56.862 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:27:56.863 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/auth/register application/json 112 - 404 0 - 2.0623ms
2023-11-06 18:28:21.875 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - -
2023-11-06 18:28:21.876 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:28:21.877 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - - - 204 - - 2.2643ms
2023-11-06 18:28:21.878 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 108
2023-11-06 18:28:21.880 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:28:21.881 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:28:21.882 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:28:21.896 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 12.8669ms
2023-11-06 18:28:21.897 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:28:21.899 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 108 - 400 - application/json 21.3052ms
2023-11-06 18:28:45.753 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - -
2023-11-06 18:28:45.756 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:28:45.756 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - - - 204 - - 3.2760ms
2023-11-06 18:28:45.757 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110
2023-11-06 18:28:45.759 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:28:45.760 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:28:45.761 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:28:45.815 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:28:45.817 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 54.1252ms
2023-11-06 18:28:45.818 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:28:45.819 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110 - 500 - application/json 61.5055ms
2023-11-06 18:29:24.838 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 152
2023-11-06 18:29:24.840 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:29:24.843 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:29:24.852 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:29:24.855 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 10.2703ms
2023-11-06 18:29:24.856 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:29:24.858 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 152 - 500 - application/json 20.2875ms
2023-11-06 18:30:16.094 +01:00 [INF] Application is shutting down...
2023-11-06 18:30:16.102 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED shutting down.
2023-11-06 18:30:16.103 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED paused.
2023-11-06 18:30:16.107 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED Shutdown complete.
2023-11-06 18:30:27.833 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-06 18:30:27.860 +01:00 [INF] Quartz Scheduler created
2023-11-06 18:30:27.862 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-06 18:30:27.863 +01:00 [INF] RAMJobStore initialized.
2023-11-06 18:30:27.864 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-06 18:30:27.865 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-06 18:30:27.866 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-06 18:30:27.875 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-06 18:30:27.878 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-06 18:30:27.948 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-06 18:30:27.950 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:30:27.951 +01:00 [INF] Hosting environment: Development
2023-11-06 18:30:27.952 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-06 18:30:27.954 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-06 18:30:28.095 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:30:28.098 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:30:28.257 +01:00 [INF] Received HTTP response headers after 154.9867ms - 200
2023-11-06 18:30:28.264 +01:00 [INF] End processing HTTP request after 172.435ms - 200
2023-11-06 18:30:28.370 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger - -
2023-11-06 18:30:28.404 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-06 18:30:28.444 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger - - - 404 0 - 90.8812ms
2023-11-06 18:30:29.631 +01:00 [INF] Executed DbCommand (47ms) [Parameters=[@__code_0='?' (Size = 3) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
WHERE [c].[Code] = @__code_0
2023-11-06 18:30:29.861 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-06 18:30:29.871 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-06 18:30:38.914 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - -
2023-11-06 18:30:38.925 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:30:38.929 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - - - 204 - - 14.2685ms
2023-11-06 18:30:38.938 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110
2023-11-06 18:30:38.940 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:30:38.986 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:30:38.999 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:30:42.361 +01:00 [INF] Executed DbCommand (120ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:31:16.813 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-06 18:31:16.843 +01:00 [INF] Quartz Scheduler created
2023-11-06 18:31:16.844 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-06 18:31:16.845 +01:00 [INF] RAMJobStore initialized.
2023-11-06 18:31:16.847 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-06 18:31:16.848 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-06 18:31:16.849 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-06 18:31:16.858 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-06 18:31:16.861 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-06 18:31:16.971 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-06 18:31:16.975 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:31:16.976 +01:00 [INF] Hosting environment: Development
2023-11-06 18:31:16.978 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-06 18:31:16.979 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-06 18:31:17.129 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:31:17.133 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:31:17.255 +01:00 [INF] Received HTTP response headers after 118.4775ms - 200
2023-11-06 18:31:17.260 +01:00 [INF] End processing HTTP request after 135.0146ms - 200
2023-11-06 18:31:17.381 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger - -
2023-11-06 18:31:17.416 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-06 18:31:17.463 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger - - - 404 0 - 84.1560ms
2023-11-06 18:31:18.510 +01:00 [INF] Executed DbCommand (45ms) [Parameters=[@__code_0='?' (Size = 3) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
WHERE [c].[Code] = @__code_0
2023-11-06 18:31:18.697 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-06 18:31:18.706 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-06 18:32:13.340 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - -
2023-11-06 18:32:13.353 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:32:13.355 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - - - 204 - - 15.0064ms
2023-11-06 18:32:13.395 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110
2023-11-06 18:32:13.397 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:32:13.442 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:32:13.456 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:32:16.810 +01:00 [INF] Executed DbCommand (124ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:32:25.446 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (Size = 255), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = Guid), @p9='?' (DbType = DateTime2), @p10='?' (Size = 255) (DbType = AnsiString), @p11='?' (Size = 40) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Id], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [Email], [Icon], [IsDeleted], [ModifiedBy], [ModifiedTime], [PasswordHash], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
2023-11-06 18:32:25.506 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Guid), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Boolean), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AccountData] ([Id], [AccountId], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [IsDeleted], [ModifiedBy], [ModifiedTime])
OUTPUT INSERTED.[ActualMoney]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
INSERT INTO [Tokens] ([Id], [AccountId], [JWTToken], [RefreshToken], [RefreshTokenExpiryTime])
VALUES (@p9, @p10, @p11, @p12, @p13);
2023-11-06 18:32:25.526 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'WalletApp.Persistence.WalletDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AccountData_Accounts_AccountId". The conflict occurred in database "WalletApp", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:23dc9a07-df13-400c-a0e5-d1c7d83ec71d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AccountData_Accounts_AccountId". The conflict occurred in database "WalletApp", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:23dc9a07-df13-400c-a0e5-d1c7d83ec71d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-06 18:32:25.666 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 12205.9088ms
2023-11-06 18:32:25.670 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:32:25.802 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110 - 500 - application/json 12407.2467ms
2023-11-06 18:32:31.657 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - -
2023-11-06 18:32:31.659 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:32:31.660 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - - - 204 - - 3.1448ms
2023-11-06 18:32:31.660 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110
2023-11-06 18:32:31.661 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:32:31.676 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:32:31.677 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:32:33.780 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:32:38.675 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 6996.7912ms
2023-11-06 18:32:38.677 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:32:38.766 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110 - 500 - application/json 7105.0170ms
2023-11-06 18:33:51.412 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-06 18:33:51.441 +01:00 [INF] Quartz Scheduler created
2023-11-06 18:33:51.443 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-06 18:33:51.444 +01:00 [INF] RAMJobStore initialized.
2023-11-06 18:33:51.445 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-06 18:33:51.446 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-06 18:33:51.447 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-06 18:33:51.456 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-06 18:33:51.459 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-06 18:33:51.544 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-06 18:33:51.547 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:33:51.548 +01:00 [INF] Hosting environment: Development
2023-11-06 18:33:51.548 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-06 18:33:51.550 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-06 18:33:51.710 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:33:51.713 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:33:51.828 +01:00 [INF] Received HTTP response headers after 112.2056ms - 200
2023-11-06 18:33:51.833 +01:00 [INF] End processing HTTP request after 127.002ms - 200
2023-11-06 18:33:52.046 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger - -
2023-11-06 18:33:52.082 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-06 18:33:52.111 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger - - - 404 0 - 67.4789ms
2023-11-06 18:33:53.100 +01:00 [INF] Executed DbCommand (43ms) [Parameters=[@__code_0='?' (Size = 3) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
WHERE [c].[Code] = @__code_0
2023-11-06 18:33:53.289 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-06 18:33:53.299 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-06 18:34:22.156 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - -
2023-11-06 18:34:22.171 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:34:22.209 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - - - 204 - - 52.8273ms
2023-11-06 18:34:22.211 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110
2023-11-06 18:34:22.215 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:34:22.258 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:34:22.274 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:35:38.317 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-06 18:35:38.344 +01:00 [INF] Quartz Scheduler created
2023-11-06 18:35:38.346 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-06 18:35:38.347 +01:00 [INF] RAMJobStore initialized.
2023-11-06 18:35:38.348 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-06 18:35:38.349 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-06 18:35:38.350 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-06 18:35:38.358 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-06 18:35:38.361 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-06 18:35:38.437 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-06 18:35:38.440 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:35:38.441 +01:00 [INF] Hosting environment: Development
2023-11-06 18:35:38.441 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-06 18:35:38.443 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-06 18:35:38.602 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:35:38.606 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:35:38.754 +01:00 [INF] Received HTTP response headers after 144.6915ms - 200
2023-11-06 18:35:38.757 +01:00 [INF] End processing HTTP request after 158.3794ms - 200
2023-11-06 18:35:39.009 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger - -
2023-11-06 18:35:39.039 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-06 18:35:39.067 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger - - - 404 0 - 60.8452ms
2023-11-06 18:35:40.018 +01:00 [INF] Executed DbCommand (45ms) [Parameters=[@__code_0='?' (Size = 3) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
WHERE [c].[Code] = @__code_0
2023-11-06 18:35:40.219 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-06 18:35:40.228 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
2023-11-06 18:36:09.835 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - -
2023-11-06 18:36:09.850 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:36:09.892 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - - - 204 - - 56.1352ms
2023-11-06 18:36:09.893 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110
2023-11-06 18:36:09.895 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:36:09.940 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:36:09.953 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:36:12.715 +01:00 [INF] Executed DbCommand (111ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:36:27.881 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 17920.1639ms
2023-11-06 18:36:27.883 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:36:28.009 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 110 - 500 - application/json 18116.2202ms
2023-11-06 18:36:33.353 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - -
2023-11-06 18:36:33.354 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:36:33.355 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/register - - - 204 - - 2.1080ms
2023-11-06 18:36:33.356 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/register application/json 111
2023-11-06 18:36:33.361 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:36:33.375 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:36:33.376 +01:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WalletApp.Application.Account.Register.RegisterCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:36:35.126 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:36:37.939 +01:00 [INF] Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Guid), @p4='?' (DbType = DateTime2), @p5='?' (Size = 255), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = Guid), @p9='?' (DbType = DateTime2), @p10='?' (Size = 255) (DbType = AnsiString), @p11='?' (Size = 40) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Id], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [Email], [Icon], [IsDeleted], [ModifiedBy], [ModifiedTime], [PasswordHash], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
2023-11-06 18:36:40.327 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:36:46.871 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Tokens] ([Id], [AccountId], [JWTToken], [RefreshToken], [RefreshTokenExpiryTime])
VALUES (@p0, @p1, @p2, @p3, @p4);
2023-11-06 18:36:49.205 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Guid), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Boolean), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AccountData] ([Id], [AccountId], [CratedBy], [CreatedTime], [DeletedBy], [DeletedTime], [IsDeleted], [ModifiedBy], [ModifiedTime])
OUTPUT INSERTED.[ActualMoney]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2023-11-06 18:36:49.218 +01:00 [INF] Executing CreatedResult, writing value of type 'null'.
2023-11-06 18:36:49.219 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Register (WalletApp.Api) in 15841.9311ms
2023-11-06 18:36:49.220 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Register (WalletApp.Api)'
2023-11-06 18:36:49.221 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/register application/json 111 - 201 0 - 15865.2064ms
2023-11-06 18:37:45.391 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/account/authenticate - -
2023-11-06 18:37:45.396 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:37:45.397 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/account/authenticate - - - 204 - - 6.4951ms
2023-11-06 18:37:45.398 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 54
2023-11-06 18:37:45.405 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:37:45.420 +01:00 [INF] Executing endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-06 18:37:45.424 +01:00 [INF] Route matched with {action = "Authentication", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WalletApp.Application.Account.Authenticate.AuthenticateDto]] Authentication(WalletApp.Application.Account.Authenticate.AuthenticateCommand, System.Threading.CancellationToken) on controller WalletApp.Controllers.AccountController (WalletApp.Api).
2023-11-06 18:37:45.447 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__email_0
2023-11-06 18:37:45.707 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [t].[Id], [t].[AccountId], [t].[JWTToken], [t].[RefreshToken], [t].[RefreshTokenExpiryTime]
FROM [Tokens] AS [t]
WHERE [t].[AccountId] = @__id_0
2023-11-06 18:37:45.738 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p11='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Guid), @p3='?' (DbType = DateTime2), @p4='?' (Size = 255), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (DbType = Guid), @p8='?' (DbType = DateTime2), @p9='?' (Size = 255) (DbType = AnsiString), @p10='?' (Size = 40) (DbType = AnsiString), @p16='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [CratedBy] = @p0, [CreatedTime] = @p1, [DeletedBy] = @p2, [DeletedTime] = @p3, [Email] = @p4, [Icon] = @p5, [IsDeleted] = @p6, [ModifiedBy] = @p7, [ModifiedTime] = @p8, [PasswordHash] = @p9, [Username] = @p10
OUTPUT 1
WHERE [Id] = @p11;
UPDATE [Tokens] SET [AccountId] = @p12, [JWTToken] = @p13, [RefreshToken] = @p14, [RefreshTokenExpiryTime] = @p15
OUTPUT 1
WHERE [Id] = @p16;
2023-11-06 18:37:45.757 +01:00 [INF] Executing ObjectResult, writing value of type 'WalletApp.Domain.Common.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 18:37:45.760 +01:00 [INF] Executed action WalletApp.Controllers.AccountController.Authentication (WalletApp.Api) in 333.7735ms
2023-11-06 18:37:45.761 +01:00 [INF] Executed endpoint 'WalletApp.Controllers.AccountController.Authentication (WalletApp.Api)'
2023-11-06 18:37:45.762 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/account/authenticate application/json 54 - 200 - application/json;+charset=utf-8 364.1065ms
2023-11-06 18:37:45.765 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5238/api/user/userData - -
2023-11-06 18:37:45.766 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:37:45.767 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5238/api/user/userData - - - 204 - - 1.6201ms
2023-11-06 18:37:45.768 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/user/userData - -
2023-11-06 18:37:45.769 +01:00 [INF] CORS policy execution successful.
2023-11-06 18:37:45.811 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[CratedBy], [a].[CreatedTime], [a].[DeletedBy], [a].[DeletedTime], [a].[Email], [a].[Icon], [a].[IsDeleted], [a].[ModifiedBy], [a].[ModifiedTime], [a].[PasswordHash], [a].[Username]
FROM [Accounts] AS [a]
WHERE [a].[Id] = @__id_0
2023-11-06 18:37:45.814 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/user/userData - - - 404 0 - 46.3950ms
2023-11-06 18:44:44.098 +01:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2023-11-06 18:44:44.125 +01:00 [INF] Quartz Scheduler created
2023-11-06 18:44:44.127 +01:00 [INF] JobFactory set to: Quartz.Simpl.MicrosoftDependencyInjectionJobFactory
2023-11-06 18:44:44.127 +01:00 [INF] RAMJobStore initialized.
2023-11-06 18:44:44.128 +01:00 [INF] Quartz Scheduler 3.7.0.0 - 'QuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2023-11-06 18:44:44.129 +01:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2023-11-06 18:44:44.130 +01:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2023-11-06 18:44:44.139 +01:00 [INF] Adding 1 jobs, 1 triggers.
2023-11-06 18:44:44.143 +01:00 [INF] Adding job: DEFAULT.NBP
2023-11-06 18:44:44.218 +01:00 [INF] Now listening on: http://localhost:5238
2023-11-06 18:44:44.220 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:44:44.221 +01:00 [INF] Hosting environment: Development
2023-11-06 18:44:44.222 +01:00 [INF] Content root path: C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api
2023-11-06 18:44:44.224 +01:00 [INF] Scheduler QuartzScheduler_$_NON_CLUSTERED started.
2023-11-06 18:44:44.368 +01:00 [INF] Start processing HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:44:44.372 +01:00 [INF] Sending HTTP request GET http://api.nbp.pl/api/exchangerates/tables/c
2023-11-06 18:44:44.526 +01:00 [INF] Received HTTP response headers after 149.8695ms - 200
2023-11-06 18:44:44.530 +01:00 [INF] End processing HTTP request after 166.6704ms - 200
2023-11-06 18:44:44.835 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger - -
2023-11-06 18:44:44.864 +01:00 [WRN] Failed to determine the https port for redirect.
2023-11-06 18:44:44.890 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger - - - 404 0 - 58.2530ms
2023-11-06 18:44:45.807 +01:00 [INF] Executed DbCommand (46ms) [Parameters=[@__code_0='?' (Size = 3) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Ask], [c].[Bid], [c].[Code], [c].[CratedBy], [c].[CreatedTime], [c].[CurrencyName], [c].[DeletedBy], [c].[DeletedTime], [c].[IsDeleted], [c].[ModifiedBy], [c].[ModifiedTime], [c].[TradingDate]
FROM [Currencies] AS [c]
WHERE [c].[Code] = @__code_0
2023-11-06 18:44:46.005 +01:00 [ERR] Job DEFAULT.NBP threw an unhandled Exception: 
System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
2023-11-06 18:44:46.017 +01:00 [ERR] Job DEFAULT.NBP threw an exception.
Quartz.SchedulerException: Job threw an unhandled exception.
 ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)
   --- End of inner exception stack trace --- [See nested exception: System.NullReferenceException: Object reference not set to an instance of an object.
   at WalletApp.Services.CurrentUserService.get_Account() in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Api\Services\CurrentUserService.cs:line 15
   at WalletApp.Persistence.WalletDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\WalletDbContext.cs:line 43
   at WalletApp.Persistence.Repositories.CurrencyRepository.Save(CancellationToken cancellationToken) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Persistence\Repositories\CurrencyRepository.cs:line 44
   at WalletApp.Infrastructure.Quartz.CallToNbpApiJob.Execute(IJobExecutionContext context) in C:\Users\maste\source\repos\wallet-app\wallet-app-backend\WalletApp.Infrastructure\Quartz\CallToNbpApiJob.cs:line 46
   at Quartz.Core.JobRunShell.Run(CancellationToken cancellationToken)]
